!function(){var t=class extends Error{constructor(t,e){super(t+(e?" caused by: "+e:"")),this.error=e,this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor)}},e={ConnectionRefused:class extends t{constructor(){super("Connection refused while attempting to connect to Persistr API")}},Fetch:class extends t{constructor(t){super(t)}},InternalError:class extends t{constructor(t){super(t?"Internal error\nWhat went wrong:\n"+t.message:"Internal error")}},InvalidBearerToken:class extends t{constructor({bearer:t}){super("Invalid bearer token: "+t)}},InvalidCredentials:class extends t{constructor(){super("Invalid credentials")}},PersistrError:t,StatusCode:class extends t{constructor(t,e,n,r){let i=r;try{const t=JSON.parse(r);t&&t.error&&(i=""+t.error)}catch(o){}super(i),this.url=t,this.statusCode=e,this.statusText=n,this.responseText=r}},UnsupportedFilter:class extends t{constructor({filter:t,on:e}){super(`Unsupported filter '${t}' on ${e}`)}},handle:async function(t){try{return await t()}catch(n){if(n instanceof e.PersistrError)throw n;if(n&&n.error&&"ECONNREFUSED"===n.error.code)throw new e.ConnectionRefused;throw n}}},n=e,r={};(function(t){!function(){"use strict";r=function(e){return(e instanceof t?e:t.from(e.toString(),"binary")).toString("base64")}}()}).call(this,require("buffer").Buffer);var i={},o=function(t){function e(){this.fetch=!1,this.DOMException=t.DOMException}return e.prototype=t,new e}("undefined"!=typeof self?self:this);function s(t){return Number.isInteger(t)&&t>=0}function a(t){this.name="ArgumentError",this.message=t}!function(t){!function(e){var n="URLSearchParams"in t,r="Symbol"in t&&"iterator"in Symbol,i="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),o="FormData"in t,s="ArrayBuffer"in t;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(t){return t&&a.indexOf(Object.prototype.toString.call(t))>-1};function c(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function l(t){return"string"!=typeof t&&(t=String(t)),t}function h(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return r&&(e[Symbol.iterator]=function(){return e}),e}function f(t){this.map={},t instanceof f?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function d(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function y(t){var e=new FileReader,n=p(e);return e.readAsArrayBuffer(t),n}function m(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:i&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:o&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():s&&i&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=m(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(t)||u(t))?this._bodyArrayBuffer=m(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var t=d(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var t,e,n,r=d(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,n=p(e=new FileReader),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(t,e){t=c(t),e=l(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},f.prototype.delete=function(t){delete this.map[c(t)]},f.prototype.get=function(t){return t=c(t),this.has(t)?this.map[t]:null},f.prototype.has=function(t){return this.map.hasOwnProperty(c(t))},f.prototype.set=function(t,e){this.map[c(t)]=l(e)},f.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},f.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),h(t)},f.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),h(t)},f.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),h(t)},r&&(f.prototype[Symbol.iterator]=f.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function _(t,e){var n,r,i=(e=e||{}).body;if(t instanceof _){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new f(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new f(e.headers)),this.method=(r=(n=e.method||this.method||"GET").toUpperCase(),g.indexOf(r)>-1?r:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function b(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}})),e}function w(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new f(e.headers),this.url=e.url||"",this._initBody(t)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})},v.call(_.prototype),v.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},w.error=function(){var t=new w(null,{status:0,statusText:""});return t.type="error",t};var k=[301,302,303,307,308];w.redirect=function(t,e){if(-1===k.indexOf(e))throw new RangeError("Invalid status code");return new w(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(E){e.DOMException=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function O(t,n){return new Promise((function(r,o){var s=new _(t,n);if(s.signal&&s.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function u(){a.abort()}a.onload=function(){var t,e,n={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new f,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}})),e)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;r(new w(i,n))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new e.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),s.headers.forEach((function(t,e){a.setRequestHeader(e,t)})),s.signal&&(s.signal.addEventListener("abort",u),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",u)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}O.polyfill=!0,t.fetch||(t.fetch=O,t.Headers=f,t.Request=_,t.Response=w),e.Headers=f,e.Request=_,e.Response=w,e.fetch=O}({})}(o),delete o.fetch.polyfill,(i=o.fetch).default=o.fetch,i.fetch=o.fetch,i.Headers=o.Headers,i.Request=o.Request,i.Response=o.Response;const u=function(t,e){if(e=e||{},"function"!=typeof t)throw new a("fetch must be a function");if("object"!=typeof e)throw new a("defaults must be an object");if(void 0!==e.retries&&!s(e.retries))throw new a("retries must be a positive integer");if(void 0!==e.retryDelay&&!s(e.retryDelay)&&"function"!=typeof e.retryDelay)throw new a("retryDelay must be a positive integer or a function returning a positive integer");if(void 0!==e.retryOn&&!Array.isArray(e.retryOn)&&"function"!=typeof e.retryOn)throw new a("retryOn property expects an array or function");return e=Object.assign({retries:3,retryDelay:1e3,retryOn:[]},e),function(n,r){var i=e.retries,o=e.retryDelay,u=e.retryOn;if(r&&void 0!==r.retries){if(!s(r.retries))throw new a("retries must be a positive integer");i=r.retries}if(r&&void 0!==r.retryDelay){if(!s(r.retryDelay)&&"function"!=typeof r.retryDelay)throw new a("retryDelay must be a positive integer or a function returning a positive integer");o=r.retryDelay}if(r&&r.retryOn){if(!Array.isArray(r.retryOn)&&"function"!=typeof r.retryOn)throw new a("retryOn property expects an array or function");u=r.retryOn}return new Promise((function(e,s){var a=function(o){t(n,r).then((function(t){Array.isArray(u)&&-1===u.indexOf(t.status)?e(t):"function"==typeof u?u(o,null,t)?c(o,null,t):e(t):o<i?c(o,null,t):e(t)})).catch((function(t){"function"==typeof u?u(o,t,null)?c(o,t,null):s(t):o<i?c(o,t,null):s(t)}))};function c(t,e,n){var r="function"==typeof o?o(t,e,n):o;setTimeout((function(){a(++t)}),r)}a(0)}))}}(i=i,{retryOn:[503],retries:3,retryDelay:function(t,e,n){return Math.pow(7,t+1)}});function c(t){let e="";if(t&&Object.keys(t).length>0){const n=encodeURIComponent;e="?"+Object.entries(t).filter(t=>t[0]&&t[1]).map(t=>n(t[0])+"="+n(t[1])).join("&")}return e}var l={};function h(){this.jobs=Array.prototype.slice.call(arguments),this.running=!1}h.prototype={add:function(t){return t&&(arguments.length>1?this.jobs=this.jobs.concat(Array.prototype.slice.call(arguments)):this.jobs.push(t)),this},run:function(t){return this.add(t),this.running||this.start(),this},start:function(){this.running=!0,this.next(!1)},success:function(){this.next(!1)},fail:function(t){t=t||"Job failed",this.next(t)},next:function(t){if(this.jobs.length){var e=this.jobs.shift();try{e(t,this)}catch(n){this.next(n)}}else this.running=!1}},l=h;var f=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t},d={},p=Object.prototype.hasOwnProperty;function y(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return null}}d.stringify=function(t,e){e=e||"";var n,r,i=[];for(r in"string"!=typeof e&&(e="?"),t)if(p.call(t,r)){if((n=t[r])||null!=n&&!isNaN(n)||(n=""),r=encodeURIComponent(r),n=encodeURIComponent(n),null===r||null===n)continue;i.push(r+"="+n)}return i.length?e+i.join("&"):""},d.parse=function(t){for(var e,n=/([^=?&]+)=?([^&]*)/g,r={};e=n.exec(t);){var i=y(e[1]),o=y(e[2]);null===i||null===o||i in r||(r[i]=o)}return r};var m={};(function(t){"use strict";var e=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,n=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,r=new RegExp("^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]+");function i(t){return(t||"").toString().replace(r,"")}var o=[["#","hash"],["?","query"],function(t){return t.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],s={hash:1,query:1};function a(n){var r,i=("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}).location||{},o={},a=typeof(n=n||i);if("blob:"===n.protocol)o=new c(unescape(n.pathname),{});else if("string"===a)for(r in o=new c(n,{}),s)delete o[r];else if("object"===a){for(r in n)r in s||(o[r]=n[r]);void 0===o.slashes&&(o.slashes=e.test(n.href))}return o}function u(t){t=i(t);var e=n.exec(t);return{protocol:e[1]?e[1].toLowerCase():"",slashes:!!e[2],rest:e[3]}}function c(t,e,n){if(t=i(t),!(this instanceof c))return new c(t,e,n);var r,s,l,h,p,y,m=o.slice(),v=typeof e,g=this,_=0;for("object"!==v&&"string"!==v&&(n=e,e=null),n&&"function"!=typeof n&&(n=d.parse),e=a(e),r=!(s=u(t||"")).protocol&&!s.slashes,g.slashes=s.slashes||r&&e.slashes,g.protocol=s.protocol||e.protocol||"",t=s.rest,s.slashes||(m[3]=[/(.*)/,"pathname"]);_<m.length;_++)"function"!=typeof(h=m[_])?(l=h[0],y=h[1],l!=l?g[y]=t:"string"==typeof l?~(p=t.indexOf(l))&&("number"==typeof h[2]?(g[y]=t.slice(0,p),t=t.slice(p+h[2])):(g[y]=t.slice(p),t=t.slice(0,p))):(p=l.exec(t))&&(g[y]=p[1],t=t.slice(0,p.index)),g[y]=g[y]||r&&h[3]&&e[y]||"",h[4]&&(g[y]=g[y].toLowerCase())):t=h(t);n&&(g.query=n(g.query)),r&&e.slashes&&"/"!==g.pathname.charAt(0)&&(""!==g.pathname||""!==e.pathname)&&(g.pathname=function(t,e){if(""===t)return e;for(var n=(e||"/").split("/").slice(0,-1).concat(t.split("/")),r=n.length,i=n[r-1],o=!1,s=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),s++):s&&(0===r&&(o=!0),n.splice(r,1),s--);return o&&n.unshift(""),"."!==i&&".."!==i||n.push(""),n.join("/")}(g.pathname,e.pathname)),f(g.port,g.protocol)||(g.host=g.hostname,g.port=""),g.username=g.password="",g.auth&&(h=g.auth.split(":"),g.username=h[0]||"",g.password=h[1]||""),g.origin=g.protocol&&g.host&&"file:"!==g.protocol?g.protocol+"//"+g.host:"null",g.href=g.toString()}c.prototype={set:function(t,e,n){var r=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(n||d.parse)(e)),r[t]=e;break;case"port":r[t]=e,f(e,r.protocol)?e&&(r.host=r.hostname+":"+e):(r.host=r.hostname,r[t]="");break;case"hostname":r[t]=e,r.port&&(e+=":"+r.port),r.host=e;break;case"host":r[t]=e,/:\d+$/.test(e)?(e=e.split(":"),r.port=e.pop(),r.hostname=e.join(":")):(r.hostname=e,r.port="");break;case"protocol":r.protocol=e.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(e){var i="pathname"===t?"/":"#";r[t]=e.charAt(0)!==i?i+e:e}else r[t]=e;break;default:r[t]=e}for(var s=0;s<o.length;s++){var a=o[s];a[4]&&(r[a[1]]=r[a[1]].toLowerCase())}return r.origin=r.protocol&&r.host&&"file:"!==r.protocol?r.protocol+"//"+r.host:"null",r.href=r.toString(),r},toString:function(t){t&&"function"==typeof t||(t=d.stringify);var e,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var i=r+(n.slashes?"//":"");return n.username&&(i+=n.username,n.password&&(i+=":"+n.password),i+="@"),i+=n.host+n.pathname,(e="object"==typeof n.query?t(n.query):n.query)&&(i+="?"!==e.charAt(0)?"?"+e:e),n.hash&&(i+=n.hash),i}},c.extractProtocol=u,c.location=a,c.trimLeft=i,c.qs=d,m=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var v={};function g(t){return"string"==typeof t&&(t=m(t)),t.protocol&&t.hostname?(t.protocol+"//"+t.host).toLowerCase():"null"}g.same=function(t,e){return g(t)===g(e)},v=g;var _={};(function(t,e){var n=require("url").parse,r=require("events"),i=require("https"),o=require("http"),s=require("util"),a=["pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","secureProtocol","servername","checkServerIdentity"],u=[239,187,191];function c(r,s){var f=c.CONNECTING;Object.defineProperty(this,"readyState",{get:function(){return f}}),Object.defineProperty(this,"url",{get:function(){return r}});var d,p=this;function y(t){f!==c.CLOSED&&(f=c.CONNECTING,O("error",new l("error",{message:t})),w&&(r=w,w=null),setTimeout((function(){f===c.CONNECTING&&k()}),p.reconnectInterval))}p.reconnectInterval=1e3;var m="";s&&s.headers&&s.headers["Last-Event-ID"]&&(m=s.headers["Last-Event-ID"],delete s.headers["Last-Event-ID"]);var g=!1,_="",b="",w=null;function k(){var h=n(r),v="https:"===h.protocol;if(h.headers={"Cache-Control":"no-cache",Accept:"text/event-stream"},m&&(h.headers["Last-Event-ID"]=m),s&&s.headers)for(var _ in s.headers){var b=s.headers[_];b&&(h.headers[_]=b)}if(h.rejectUnauthorized=!(s&&!s.rejectUnauthorized),s&&s.proxy){var S=n(s.proxy);v="https:"===S.protocol,h.protocol=v?"https:":"http:",h.path=r,h.headers.Host=h.host,h.hostname=S.hostname,h.host=S.host,h.port=S.port}if(s&&s.https)for(var x in s.https)if(-1!==a.indexOf(x)){var C=s.https[x];void 0!==C&&(h[x]=C)}s&&void 0!==s.withCredentials&&(h.withCredentials=s.withCredentials),(d=(v?i:o).request(h,(function(n){if(500===n.statusCode||502===n.statusCode||503===n.statusCode||504===n.statusCode)return O("error",new l("error",{status:n.statusCode,message:n.statusMessage})),void y();if(301===n.statusCode||307===n.statusCode)return n.headers.location?(307===n.statusCode&&(w=r),r=n.headers.location,void t.nextTick(k)):void O("error",new l("error",{status:n.statusCode,message:n.statusMessage}));if(200!==n.statusCode)return O("error",new l("error",{status:n.statusCode,message:n.statusMessage})),p.close();f=c.OPEN,n.on("close",(function(){n.removeAllListeners("close"),n.removeAllListeners("end"),y()})),n.on("end",(function(){n.removeAllListeners("close"),n.removeAllListeners("end"),y()})),O("open",new l("open"));var i,o=!0;n.on("data",(function(t){i=i?e.concat([i,t]):t,o&&function(t){return u.every((function(e,n){return t[n]===e}))}(i)&&(i=i.slice(u.length)),o=!1;for(var n=0,r=i.length;n<r;){g&&(10===i[n]&&++n,g=!1);for(var s,a=-1,c=-1,l=n;a<0&&l<r;++l)58===(s=i[l])?c<0&&(c=l-n):13===s?(g=!0,a=l-n):10===s&&(a=l-n);if(a<0)break;E(i,n,c,a),n+=a+1}n===r?i=void 0:n>0&&(i=i.slice(n))}))}))).on("error",(function(t){y(t.message)})),d.setNoDelay&&d.setNoDelay(!0),d.end()}function O(){p.listeners(arguments[0]).length>0&&p.emit.apply(p,arguments)}function E(t,e,n,i){if(0===i){if(_.length>0){var o=b||"message";O(o,new h(o,{data:_.slice(0,-1),lastEventId:m,origin:v(r)})),_=""}b=void 0}else if(n>0){var s,a=n<0,u=t.slice(e,e+(a?i:n)).toString();e+=s=a?i:32!==t[e+n+1]?n+1:n+2;var c=i-s,l=t.slice(e,e+c).toString();if("data"===u)_+=l+"\n";else if("event"===u)b=l;else if("id"===u)m=l;else if("retry"===u){var f=parseInt(l,10);Number.isNaN(f)||(p.reconnectInterval=f)}}}k(),this._close=function(){f!==c.CLOSED&&(f=c.CLOSED,d.abort&&d.abort(),d.xhr&&d.xhr.abort&&d.xhr.abort())}}function l(t,e){if(Object.defineProperty(this,"type",{writable:!1,value:t,enumerable:!0}),e)for(var n in e)e.hasOwnProperty(n)&&Object.defineProperty(this,n,{writable:!1,value:e[n],enumerable:!0})}function h(t,e){for(var n in Object.defineProperty(this,"type",{writable:!1,value:t,enumerable:!0}),e)e.hasOwnProperty(n)&&Object.defineProperty(this,n,{writable:!1,value:e[n],enumerable:!0})}_=c,s.inherits(c,r.EventEmitter),c.prototype.constructor=c,["open","error","message"].forEach((function(t){Object.defineProperty(c.prototype,"on"+t,{get:function(){var e=this.listeners(t)[0];return e?e._listener?e._listener:e:void 0},set:function(e){this.removeAllListeners(t),this.addEventListener(t,e)}})})),Object.defineProperty(c,"CONNECTING",{enumerable:!0,value:0}),Object.defineProperty(c,"OPEN",{enumerable:!0,value:1}),Object.defineProperty(c,"CLOSED",{enumerable:!0,value:2}),c.prototype.CONNECTING=0,c.prototype.OPEN=1,c.prototype.CLOSED=2,c.prototype.close=function(){this._close()},c.prototype.addEventListener=function(t,e){"function"==typeof e&&(e._listener=e,this.on(t,e))},c.prototype.dispatchEvent=function(t){if(!t.type)throw new Error("UNSPECIFIED_EVENT_TYPE_ERR");this.emit(t.type,t.detail)},c.prototype.removeEventListener=function(t,e){"function"==typeof e&&(e._listener=void 0,this.removeListener(t,e))}}).call(this,require("_process"),require("buffer").Buffer);var b={};function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t,e,n){return e&&w(t.prototype,e),n&&w(t,n),t}function O(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t,e,n){return(x=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&S(i,n.prototype),i}).apply(null,arguments)}function C(t){var e="function"==typeof Map?new Map:void 0;return(C=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return x(t,arguments,E(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),S(r,t)})(t)}Object.defineProperty(b,"__esModule",{value:!0});var T=function(t){function e(){return t.apply(this,arguments)||this}return O(e,t),e}(C(Error)),j=function(t){function e(e){return t.call(this,"Invalid DateTime: "+e.toMessage())||this}return O(e,t),e}(T),F=function(t){function e(e){return t.call(this,"Invalid Interval: "+e.toMessage())||this}return O(e,t),e}(T),A=function(t){function e(e){return t.call(this,"Invalid Duration: "+e.toMessage())||this}return O(e,t),e}(T),N=function(t){function e(){return t.apply(this,arguments)||this}return O(e,t),e}(T),D=function(t){function e(e){return t.call(this,"Invalid unit "+e)||this}return O(e,t),e}(T),P=function(t){function e(){return t.apply(this,arguments)||this}return O(e,t),e}(T),I=function(t){function e(){return t.call(this,"Zone is an abstract class")||this}return O(e,t),e}(T),R="numeric",M="short",L="long",V={year:R,month:R,day:R},$={year:R,month:M,day:R},q={year:R,month:L,day:R},U={year:R,month:L,day:R,weekday:L},z={hour:R,minute:R},H={hour:R,minute:R,second:R},B={hour:R,minute:R,second:R,timeZoneName:M},Z={hour:R,minute:R,second:R,timeZoneName:L},G={hour:R,minute:R,hour12:!1},W={hour:R,minute:R,second:R,hour12:!1},J={hour:R,minute:R,second:R,hour12:!1,timeZoneName:M},Q={hour:R,minute:R,second:R,hour12:!1,timeZoneName:L},Y={year:R,month:R,day:R,hour:R,minute:R},X={year:R,month:R,day:R,hour:R,minute:R,second:R},K={year:R,month:M,day:R,hour:R,minute:R},tt={year:R,month:M,day:R,hour:R,minute:R,second:R},et={year:R,month:M,day:R,weekday:M,hour:R,minute:R},nt={year:R,month:L,day:R,hour:R,minute:R,timeZoneName:M},rt={year:R,month:L,day:R,hour:R,minute:R,second:R,timeZoneName:M},it={year:R,month:L,day:R,weekday:L,hour:R,minute:R,timeZoneName:L},ot={year:R,month:L,day:R,weekday:L,hour:R,minute:R,second:R,timeZoneName:L};function st(t){return void 0===t}function at(t){return"number"==typeof t}function ut(t){return"number"==typeof t&&t%1==0}function ct(){try{return"undefined"!=typeof Intl&&Intl.DateTimeFormat}catch(t){return!1}}function lt(){return!st(Intl.DateTimeFormat.prototype.formatToParts)}function ht(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(t){return!1}}function ft(t,e,n){if(0!==t.length)return t.reduce((function(t,r){var i=[e(r),r];return t&&n(t[0],i[0])===t[0]?t:i}),null)[1]}function dt(t,e){return e.reduce((function(e,n){return e[n]=t[n],e}),{})}function pt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function yt(t,e,n){return ut(t)&&t>=e&&t<=n}function mt(t,e){return void 0===e&&(e=2),t.toString().length<e?("0".repeat(e)+t).slice(-e):t.toString()}function vt(t){return st(t)||null===t||""===t?void 0:parseInt(t,10)}function gt(t){if(!st(t)&&null!==t&&""!==t){var e=1e3*parseFloat("0."+t);return Math.floor(e)}}function _t(t,e,n){void 0===n&&(n=!1);var r=Math.pow(10,e);return(n?Math.trunc:Math.round)(t*r)/r}function bt(t){return t%4==0&&(t%100!=0||t%400==0)}function wt(t){return bt(t)?366:365}function kt(t,e){var n,r=(n=e-1)-12*Math.floor(n/12)+1;return 2===r?bt(t+(e-r)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][r-1]}function Ot(t){var e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e)).setUTCFullYear(e.getUTCFullYear()-1900),+e}function Et(t){var e=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7,n=t-1,r=(n+Math.floor(n/4)-Math.floor(n/100)+Math.floor(n/400))%7;return 4===e||3===r?53:52}function St(t){return t>99?t:t>60?1900+t:2e3+t}function xt(t,e,n,r){void 0===r&&(r=null);var i=new Date(t),o={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(o.timeZone=r);var s=Object.assign({timeZoneName:e},o),a=ct();if(a&&lt()){var u=new Intl.DateTimeFormat(n,s).formatToParts(i).find((function(t){return"timezonename"===t.type.toLowerCase()}));return u?u.value:null}if(a){var c=new Intl.DateTimeFormat(n,o).format(i);return new Intl.DateTimeFormat(n,s).format(i).substring(c.length).replace(/^[, \u200e]+/,"")}return null}function Ct(t,e){var n=parseInt(t,10);Number.isNaN(n)&&(n=0);var r=parseInt(e,10)||0;return 60*n+(n<0||Object.is(n,-0)?-r:r)}function Tt(t){var e=Number(t);if("boolean"==typeof t||""===t||Number.isNaN(e))throw new P("Invalid unit value "+t);return e}function jt(t,e,n){var r={};for(var i in t)if(pt(t,i)){if(n.indexOf(i)>=0)continue;var o=t[i];if(null==o)continue;r[e(i)]=Tt(o)}return r}function Ft(t,e){var n=Math.trunc(t/60),r=Math.abs(t%60),i=n>=0&&!Object.is(n,-0)?"+":"-",o=""+i+Math.abs(n);switch(e){case"short":return""+i+mt(Math.abs(n),2)+":"+mt(r,2);case"narrow":return r>0?o+":"+r:o;case"techie":return""+i+mt(Math.abs(n),2)+mt(r,2);default:throw new RangeError("Value format "+e+" is out of range for property format")}}function At(t){return dt(t,["hour","minute","second","millisecond"])}var Nt=/[A-Za-z_+-]{1,256}(:?\/[A-Za-z_+-]{1,256}(\/[A-Za-z_+-]{1,256})?)?/;function Dt(t){return JSON.stringify(t,Object.keys(t).sort())}var Pt=["January","February","March","April","May","June","July","August","September","October","November","December"],It=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Rt=["J","F","M","A","M","J","J","A","S","O","N","D"];function Mt(t){switch(t){case"narrow":return Rt;case"short":return It;case"long":return Pt;case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var Lt=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Vt=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],$t=["M","T","W","T","F","S","S"];function qt(t){switch(t){case"narrow":return $t;case"short":return Vt;case"long":return Lt;case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var Ut=["AM","PM"],zt=["Before Christ","Anno Domini"],Ht=["BC","AD"],Bt=["B","A"];function Zt(t){switch(t){case"narrow":return Bt;case"short":return Ht;case"long":return zt;default:return null}}function Gt(t,e){var n="",r=t,i=Array.isArray(r),o=0;for(r=i?r:r[Symbol.iterator]();;){var s;if(i){if(o>=r.length)break;s=r[o++]}else{if((o=r.next()).done)break;s=o.value}var a=s;a.literal?n+=a.val:n+=e(a.val)}return n}var Wt={D:V,DD:$,DDD:q,DDDD:U,t:z,tt:H,ttt:B,tttt:Z,T:G,TT:W,TTT:J,TTTT:Q,f:Y,ff:K,fff:nt,ffff:it,F:X,FF:tt,FFF:rt,FFFF:ot},Jt=function(){function t(t,e){this.opts=e,this.loc=t,this.systemLoc=null}t.create=function(e,n){return void 0===n&&(n={}),new t(e,n)},t.parseFormat=function(t){for(var e=null,n="",r=!1,i=[],o=0;o<t.length;o++){var s=t.charAt(o);"'"===s?(n.length>0&&i.push({literal:r,val:n}),e=null,n="",r=!r):r||s===e?n+=s:(n.length>0&&i.push({literal:!1,val:n}),n=s,e=s)}return n.length>0&&i.push({literal:r,val:n}),i},t.macroTokenToFormatOpts=function(t){return Wt[t]};var e=t.prototype;return e.formatWithSystemDefault=function(t,e){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(t,Object.assign({},this.opts,e)).format()},e.formatDateTime=function(t,e){return void 0===e&&(e={}),this.loc.dtFormatter(t,Object.assign({},this.opts,e)).format()},e.formatDateTimeParts=function(t,e){return void 0===e&&(e={}),this.loc.dtFormatter(t,Object.assign({},this.opts,e)).formatToParts()},e.resolvedOptions=function(t,e){return void 0===e&&(e={}),this.loc.dtFormatter(t,Object.assign({},this.opts,e)).resolvedOptions()},e.num=function(t,e){if(void 0===e&&(e=0),this.opts.forceSimple)return mt(t,e);var n=Object.assign({},this.opts);return e>0&&(n.padTo=e),this.loc.numberFormatter(n).format(t)},e.formatDateTimeFromString=function(e,n){var r=this,i="en"===this.loc.listingMode(),o=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar&&lt(),s=function(t,n){return r.loc.extract(e,t,n)},a=function(t){return e.isOffsetFixed&&0===e.offset&&t.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,t.format):""},u=function(t,n){return i?function(t,e){return Mt(e)[t.month-1]}(e,t):s(n?{month:t}:{month:t,day:"numeric"},"month")},c=function(t,n){return i?function(t,e){return qt(e)[t.weekday-1]}(e,t):s(n?{weekday:t}:{weekday:t,month:"long",day:"numeric"},"weekday")},l=function(t){return i?function(t,e){return Zt(e)[t.year<0?0:1]}(e,t):s({era:t},"era")};return Gt(t.parseFormat(n),(function(n){switch(n){case"S":return r.num(e.millisecond);case"u":case"SSS":return r.num(e.millisecond,3);case"s":return r.num(e.second);case"ss":return r.num(e.second,2);case"m":return r.num(e.minute);case"mm":return r.num(e.minute,2);case"h":return r.num(e.hour%12==0?12:e.hour%12);case"hh":return r.num(e.hour%12==0?12:e.hour%12,2);case"H":return r.num(e.hour);case"HH":return r.num(e.hour,2);case"Z":return a({format:"narrow",allowZ:r.opts.allowZ});case"ZZ":return a({format:"short",allowZ:r.opts.allowZ});case"ZZZ":return a({format:"techie",allowZ:!1});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:r.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:r.loc.locale});case"z":return e.zoneName;case"a":return i?function(t){return Ut[t.hour<12?0:1]}(e):s({hour:"numeric",hour12:!0},"dayperiod");case"d":return o?s({day:"numeric"},"day"):r.num(e.day);case"dd":return o?s({day:"2-digit"},"day"):r.num(e.day,2);case"c":return r.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"E":return r.num(e.weekday);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return o?s({month:"numeric",day:"numeric"},"month"):r.num(e.month);case"LL":return o?s({month:"2-digit",day:"numeric"},"month"):r.num(e.month,2);case"LLL":return u("short",!0);case"LLLL":return u("long",!0);case"LLLLL":return u("narrow",!0);case"M":return o?s({month:"numeric"},"month"):r.num(e.month);case"MM":return o?s({month:"2-digit"},"month"):r.num(e.month,2);case"MMM":return u("short",!1);case"MMMM":return u("long",!1);case"MMMMM":return u("narrow",!1);case"y":return o?s({year:"numeric"},"year"):r.num(e.year);case"yy":return o?s({year:"2-digit"},"year"):r.num(e.year.toString().slice(-2),2);case"yyyy":return o?s({year:"numeric"},"year"):r.num(e.year,4);case"yyyyyy":return o?s({year:"numeric"},"year"):r.num(e.year,6);case"G":return l("short");case"GG":return l("long");case"GGGGG":return l("narrow");case"kk":return r.num(e.weekYear.toString().slice(-2),2);case"kkkk":return r.num(e.weekYear,4);case"W":return r.num(e.weekNumber);case"WW":return r.num(e.weekNumber,2);case"o":return r.num(e.ordinal);case"ooo":return r.num(e.ordinal,3);case"q":return r.num(e.quarter);case"qq":return r.num(e.quarter,2);case"X":return r.num(Math.floor(e.ts/1e3));case"x":return r.num(e.ts);default:return function(n){var i=t.macroTokenToFormatOpts(n);return i?r.formatWithSystemDefault(e,i):n}(n)}}))},e.formatDurationFromString=function(e,n){var r,i=this,o=function(t){switch(t[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"M":return"month";case"y":return"year";default:return null}},s=t.parseFormat(n),a=s.reduce((function(t,e){var n=e.literal,r=e.val;return n?t:t.concat(r)}),[]),u=e.shiftTo.apply(e,a.map(o).filter((function(t){return t})));return Gt(s,(r=u,function(t){var e=o(t);return e?i.num(r.get(e),t.length):t}))},t}(),Qt=function(){function t(t,e){this.reason=t,this.explanation=e}return t.prototype.toMessage=function(){return this.explanation?this.reason+": "+this.explanation:this.reason},t}(),Yt=function(){function t(){}var e=t.prototype;return e.offsetName=function(t,e){throw new I},e.formatOffset=function(t,e){throw new I},e.offset=function(t){throw new I},e.equals=function(t){throw new I},k(t,[{key:"type",get:function(){throw new I}},{key:"name",get:function(){throw new I}},{key:"universal",get:function(){throw new I}},{key:"isValid",get:function(){throw new I}}]),t}(),Xt=null,Kt=function(t){function e(){return t.apply(this,arguments)||this}O(e,t);var n=e.prototype;return n.offsetName=function(t,e){return xt(t,e.format,e.locale)},n.formatOffset=function(t,e){return Ft(this.offset(t),e)},n.offset=function(t){return-new Date(t).getTimezoneOffset()},n.equals=function(t){return"local"===t.type},k(e,[{key:"type",get:function(){return"local"}},{key:"name",get:function(){return ct()?(new Intl.DateTimeFormat).resolvedOptions().timeZone:"local"}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return!0}}],[{key:"instance",get:function(){return null===Xt&&(Xt=new e),Xt}}]),e}(Yt),te=RegExp("^"+Nt.source+"$"),ee={},ne={year:0,month:1,day:2,hour:3,minute:4,second:5},re={},ie=function(t){function e(n){var r;return(r=t.call(this)||this).zoneName=n,r.valid=e.isValidZone(n),r}O(e,t),e.create=function(t){return re[t]||(re[t]=new e(t)),re[t]},e.resetCache=function(){re={},ee={}},e.isValidSpecifier=function(t){return!(!t||!t.match(te))},e.isValidZone=function(t){try{return new Intl.DateTimeFormat("en-US",{timeZone:t}).format(),!0}catch(e){return!1}},e.parseGMTOffset=function(t){if(t){var e=t.match(/^Etc\/GMT([+-]\d{1,2})$/i);if(e)return-60*parseInt(e[1])}return null};var n=e.prototype;return n.offsetName=function(t,e){return xt(t,e.format,e.locale,this.name)},n.formatOffset=function(t,e){return Ft(this.offset(t),e)},n.offset=function(t){var e,n=new Date(t),r=(e=this.name,ee[e]||(ee[e]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),ee[e]),i=r.formatToParts?function(t,e){for(var n=t.formatToParts(e),r=[],i=0;i<n.length;i++){var o=n[i],s=o.type,a=o.value,u=ne[s];st(u)||(r[u]=parseInt(a,10))}return r}(r,n):function(t,e){var n=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(n),i=r[1],o=r[2];return[r[3],i,o,r[4],r[5],r[6]]}(r,n),o=i[0],s=i[1],a=i[2],u=i[3],c=Ot({year:o,month:s,day:a,hour:24===u?0:u,minute:i[4],second:i[5],millisecond:0}),l=n.valueOf();return(c-(l-=l%1e3))/6e4},n.equals=function(t){return"iana"===t.type&&t.name===this.name},k(e,[{key:"type",get:function(){return"iana"}},{key:"name",get:function(){return this.zoneName}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return this.valid}}]),e}(Yt),oe=null,se=function(t){function e(e){var n;return(n=t.call(this)||this).fixed=e,n}O(e,t),e.instance=function(t){return 0===t?e.utcInstance:new e(t)},e.parseSpecifier=function(t){if(t){var n=t.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(n)return new e(Ct(n[1],n[2]))}return null},k(e,null,[{key:"utcInstance",get:function(){return null===oe&&(oe=new e(0)),oe}}]);var n=e.prototype;return n.offsetName=function(){return this.name},n.formatOffset=function(t,e){return Ft(this.fixed,e)},n.offset=function(){return this.fixed},n.equals=function(t){return"fixed"===t.type&&t.fixed===this.fixed},k(e,[{key:"type",get:function(){return"fixed"}},{key:"name",get:function(){return 0===this.fixed?"UTC":"UTC"+Ft(this.fixed,"narrow")}},{key:"universal",get:function(){return!0}},{key:"isValid",get:function(){return!0}}]),e}(Yt),ae=function(t){function e(e){var n;return(n=t.call(this)||this).zoneName=e,n}O(e,t);var n=e.prototype;return n.offsetName=function(){return null},n.formatOffset=function(){return""},n.offset=function(){return NaN},n.equals=function(){return!1},k(e,[{key:"type",get:function(){return"invalid"}},{key:"name",get:function(){return this.zoneName}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return!1}}]),e}(Yt);function ue(t,e){var n;if(st(t)||null===t)return e;if(t instanceof Yt)return t;if("string"==typeof t){var r=t.toLowerCase();return"local"===r?e:"utc"===r||"gmt"===r?se.utcInstance:null!=(n=ie.parseGMTOffset(t))?se.instance(n):ie.isValidSpecifier(r)?ie.create(t):se.parseSpecifier(r)||new ae(t)}return at(t)?se.instance(t):"object"==typeof t&&t.offset&&"number"==typeof t.offset?t:new ae(t)}var ce=function(){return Date.now()},le=null,he=null,fe=null,de=null,pe=!1,ye=function(){function t(){}return t.resetCaches=function(){Se.resetCache(),ie.resetCache()},k(t,null,[{key:"now",get:function(){return ce},set:function(t){ce=t}},{key:"defaultZoneName",get:function(){return t.defaultZone.name},set:function(t){le=t?ue(t):null}},{key:"defaultZone",get:function(){return le||Kt.instance}},{key:"defaultLocale",get:function(){return he},set:function(t){he=t}},{key:"defaultNumberingSystem",get:function(){return fe},set:function(t){fe=t}},{key:"defaultOutputCalendar",get:function(){return de},set:function(t){de=t}},{key:"throwOnInvalid",get:function(){return pe},set:function(t){pe=t}}]),t}(),me={};function ve(t,e){void 0===e&&(e={});var n=JSON.stringify([t,e]),r=me[n];return r||(r=new Intl.DateTimeFormat(t,e),me[n]=r),r}var ge={},_e={},be=null;function we(t,e,n,r,i){var o=t.listingMode(n);return"error"===o?null:"en"===o?r(e):i(e)}var ke=function(){function t(t,e,n){if(this.padTo=n.padTo||0,this.floor=n.floor||!1,!e&&ct()){var r={useGrouping:!1};n.padTo>0&&(r.minimumIntegerDigits=n.padTo),this.inf=function(t,e){void 0===e&&(e={});var n=JSON.stringify([t,e]),r=ge[n];return r||(r=new Intl.NumberFormat(t,e),ge[n]=r),r}(t,r)}}return t.prototype.format=function(t){if(this.inf){var e=this.floor?Math.floor(t):t;return this.inf.format(e)}return mt(this.floor?Math.floor(t):_t(t,3),this.padTo)},t}(),Oe=function(){function t(t,e,n){var r;if(this.opts=n,this.hasIntl=ct(),t.zone.universal&&this.hasIntl?(r="UTC",n.timeZoneName?this.dt=t:this.dt=0===t.offset?t:gr.fromMillis(t.ts+60*t.offset*1e3)):"local"===t.zone.type?this.dt=t:(this.dt=t,r=t.zone.name),this.hasIntl){var i=Object.assign({},this.opts);r&&(i.timeZone=r),this.dtf=ve(e,i)}}var e=t.prototype;return e.format=function(){if(this.hasIntl)return this.dtf.format(this.dt.toJSDate());var t=function(t){switch(Dt(dt(t,["weekday","era","year","month","day","hour","minute","second","timeZoneName","hour12"]))){case Dt(V):return"M/d/yyyy";case Dt($):return"LLL d, yyyy";case Dt(q):return"LLLL d, yyyy";case Dt(U):return"EEEE, LLLL d, yyyy";case Dt(z):return"h:mm a";case Dt(H):return"h:mm:ss a";case Dt(B):case Dt(Z):return"h:mm a";case Dt(G):return"HH:mm";case Dt(W):return"HH:mm:ss";case Dt(J):case Dt(Q):return"HH:mm";case Dt(Y):return"M/d/yyyy, h:mm a";case Dt(K):return"LLL d, yyyy, h:mm a";case Dt(nt):return"LLLL d, yyyy, h:mm a";case Dt(it):return"EEEE, LLLL d, yyyy, h:mm a";case Dt(X):return"M/d/yyyy, h:mm:ss a";case Dt(tt):return"LLL d, yyyy, h:mm:ss a";case Dt(et):return"EEE, d LLL yyyy, h:mm a";case Dt(rt):return"LLLL d, yyyy, h:mm:ss a";case Dt(ot):return"EEEE, LLLL d, yyyy, h:mm:ss a";default:return"EEEE, LLLL d, yyyy, h:mm a"}}(this.opts),e=Se.create("en-US");return Jt.create(e).formatDateTimeFromString(this.dt,t)},e.formatToParts=function(){return this.hasIntl&&lt()?this.dtf.formatToParts(this.dt.toJSDate()):[]},e.resolvedOptions=function(){return this.hasIntl?this.dtf.resolvedOptions():{locale:"en-US",numberingSystem:"latn",outputCalendar:"gregory"}},t}(),Ee=function(){function t(t,e,n){this.opts=Object.assign({style:"long"},n),!e&&ht()&&(this.rtf=function(t,e){void 0===e&&(e={});var n=JSON.stringify([t,e]),r=_e[n];return r||(r=new Intl.RelativeTimeFormat(t,e),_e[n]=r),r}(t,n))}var e=t.prototype;return e.format=function(t,e){return this.rtf?this.rtf.format(t,e):function(t,e,n,r){void 0===n&&(n="always"),void 0===r&&(r=!1);var i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},o=-1===["hours","minutes","seconds"].indexOf(t);if("auto"===n&&o){var s="days"===t;switch(e){case 1:return s?"tomorrow":"next "+i[t][0];case-1:return s?"yesterday":"last "+i[t][0];case 0:return s?"today":"this "+i[t][0]}}var a=Object.is(e,-0)||e<0,u=Math.abs(e),c=1===u,l=i[t],h=r?c?l[1]:l[2]||l[1]:c?i[t][0]:t;return a?u+" "+h+" ago":"in "+u+" "+h}(e,t,this.opts.numeric,"long"!==this.opts.style)},e.formatToParts=function(t,e){return this.rtf?this.rtf.formatToParts(t,e):[]},t}(),Se=function(){function t(t,e,n,r){var i=function(t){var e=t.indexOf("-u-");if(-1===e)return[t];var n,r=t.substring(0,e);try{n=ve(t).resolvedOptions()}catch(o){n=ve(r).resolvedOptions()}var i=n;return[r,i.numberingSystem,i.calendar]}(t),o=i[0],s=i[1],a=i[2];this.locale=o,this.numberingSystem=e||s||null,this.outputCalendar=n||a||null,this.intl=function(t,e,n){return ct()?n||e?(t+="-u",n&&(t+="-ca-"+n),e&&(t+="-nu-"+e),t):t:[]}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=r,this.fastNumbersCached=null}t.fromOpts=function(e){return t.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)},t.create=function(e,n,r,i){void 0===i&&(i=!1);var o=e||ye.defaultLocale;return new t(o||(i?"en-US":function(){if(be)return be;if(ct()){var t=(new Intl.DateTimeFormat).resolvedOptions().locale;return be=t&&"und"!==t?t:"en-US"}return be="en-US"}()),n||ye.defaultNumberingSystem,r||ye.defaultOutputCalendar,o)},t.resetCache=function(){be=null,me={},ge={},_e={}},t.fromObject=function(e){var n=void 0===e?{}:e,r=n.locale,i=n.numberingSystem,o=n.outputCalendar;return t.create(r,i,o)};var e=t.prototype;return e.listingMode=function(t){void 0===t&&(t=!0);var e=ct()&&lt(),n=this.isEnglish(),r=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return e||n&&r||t?!e||n&&r?"en":"intl":"error"},e.clone=function(e){return e&&0!==Object.getOwnPropertyNames(e).length?t.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1):this},e.redefaultToEN=function(t){return void 0===t&&(t={}),this.clone(Object.assign({},t,{defaultToEN:!0}))},e.redefaultToSystem=function(t){return void 0===t&&(t={}),this.clone(Object.assign({},t,{defaultToEN:!1}))},e.months=function(t,e,n){var r=this;return void 0===e&&(e=!1),void 0===n&&(n=!0),we(this,t,n,Mt,(function(){var n=e?{month:t,day:"numeric"}:{month:t},i=e?"format":"standalone";return r.monthsCache[i][t]||(r.monthsCache[i][t]=function(t){for(var e=[],n=1;n<=12;n++){var r=gr.utc(2016,n,1);e.push(t(r))}return e}((function(t){return r.extract(t,n,"month")}))),r.monthsCache[i][t]}))},e.weekdays=function(t,e,n){var r=this;return void 0===e&&(e=!1),void 0===n&&(n=!0),we(this,t,n,qt,(function(){var n=e?{weekday:t,year:"numeric",month:"long",day:"numeric"}:{weekday:t},i=e?"format":"standalone";return r.weekdaysCache[i][t]||(r.weekdaysCache[i][t]=function(t){for(var e=[],n=1;n<=7;n++){var r=gr.utc(2016,11,13+n);e.push(t(r))}return e}((function(t){return r.extract(t,n,"weekday")}))),r.weekdaysCache[i][t]}))},e.meridiems=function(t){var e=this;return void 0===t&&(t=!0),we(this,void 0,t,(function(){return Ut}),(function(){if(!e.meridiemCache){var t={hour:"numeric",hour12:!0};e.meridiemCache=[gr.utc(2016,11,13,9),gr.utc(2016,11,13,19)].map((function(n){return e.extract(n,t,"dayperiod")}))}return e.meridiemCache}))},e.eras=function(t,e){var n=this;return void 0===e&&(e=!0),we(this,t,e,Zt,(function(){var e={era:t};return n.eraCache[t]||(n.eraCache[t]=[gr.utc(-40,1,1),gr.utc(2017,1,1)].map((function(t){return n.extract(t,e,"era")}))),n.eraCache[t]}))},e.extract=function(t,e,n){var r=this.dtFormatter(t,e).formatToParts().find((function(t){return t.type.toLowerCase()===n}));return r?r.value:null},e.numberFormatter=function(t){return void 0===t&&(t={}),new ke(this.intl,t.forceSimple||this.fastNumbers,t)},e.dtFormatter=function(t,e){return void 0===e&&(e={}),new Oe(t,this.intl,e)},e.relFormatter=function(t){return void 0===t&&(t={}),new Ee(this.intl,this.isEnglish(),t)},e.isEnglish=function(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||ct()&&new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")},e.equals=function(t){return this.locale===t.locale&&this.numberingSystem===t.numberingSystem&&this.outputCalendar===t.outputCalendar},k(t,[{key:"fastNumbers",get:function(){return null==this.fastNumbersCached&&(this.fastNumbersCached=(!this.numberingSystem||"latn"===this.numberingSystem)&&("latn"===this.numberingSystem||!this.locale||this.locale.startsWith("en")||ct()&&"latn"===new Intl.DateTimeFormat(this.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}}]),t}();function xe(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.reduce((function(t,e){return t+e.source}),"");return RegExp("^"+r+"$")}function Ce(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce((function(e,n){var r=e[0],i=e[1],o=e[2],s=n(t,o),a=s[0],u=s[1],c=s[2];return[Object.assign(r,a),i||u,c]}),[{},null,1]).slice(0,2)}}function Te(t){if(null==t)return[null,null];for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i=0,o=n;i<o.length;i++){var s=o[i],a=s[0],u=s[1],c=a.exec(t);if(c)return u(c)}return[null,null]}function je(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t,n){var r,i={};for(r=0;r<e.length;r++)i[e[r]]=vt(t[n+r]);return[i,null,n+r]}}var Fe=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Ae=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,9}))?)?)?/,Ne=RegExp(""+Ae.source+Fe.source+"?"),De=RegExp("(?:T"+Ne.source+")?"),Pe=je("weekYear","weekNumber","weekDay"),Ie=je("year","ordinal"),Re=RegExp(Ae.source+" ?(?:"+Fe.source+"|("+Nt.source+"))?"),Me=RegExp("(?: "+Re.source+")?");function Le(t,e,n){var r=t[e];return st(r)?n:vt(r)}function Ve(t,e){return[{year:Le(t,e),month:Le(t,e+1,1),day:Le(t,e+2,1)},null,e+3]}function $e(t,e){return[{hour:Le(t,e,0),minute:Le(t,e+1,0),second:Le(t,e+2,0),millisecond:gt(t[e+3])},null,e+4]}function qe(t,e){var n=!t[e]&&!t[e+1],r=Ct(t[e+1],t[e+2]);return[{},n?null:se.instance(r),e+3]}function Ue(t,e){return[{},t[e]?ie.create(t[e]):null,e+1]}var ze=/^P(?:(?:(-?\d{1,9})Y)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})W)?(?:(-?\d{1,9})D)?(?:T(?:(-?\d{1,9})H)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})(?:[.,](-?\d{1,9}))?S)?)?)$/;function He(t){var e=t[1],n=t[2],r=t[3],i=t[4],o=t[5],s=t[6],a=t[7],u=t[8];return[{years:vt(e),months:vt(n),weeks:vt(r),days:vt(i),hours:vt(o),minutes:vt(s),seconds:vt(a),milliseconds:gt(u)}]}var Be={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Ze(t,e,n,r,i,o,s){var a={year:2===e.length?St(vt(e)):vt(e),month:It.indexOf(n)+1,day:vt(r),hour:vt(i),minute:vt(o)};return s&&(a.second=vt(s)),t&&(a.weekday=t.length>3?Lt.indexOf(t)+1:Vt.indexOf(t)+1),a}var Ge=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function We(t){var e,n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11],d=Ze(n,o,i,r,s,a,u);return e=c?Be[c]:l?0:Ct(h,f),[d,new se(e)]}var Je=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Qe=/^(Monday|Tuesday|Wedsday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Ye=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Xe(t){var e=t[1],n=t[2],r=t[3];return[Ze(e,t[4],r,n,t[5],t[6],t[7]),se.utcInstance]}function Ke(t){var e=t[1],n=t[2],r=t[3],i=t[4],o=t[5],s=t[6];return[Ze(e,t[7],n,r,i,o,s),se.utcInstance]}var tn=xe(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,De),en=xe(/(\d{4})-?W(\d\d)(?:-?(\d))?/,De),nn=xe(/(\d{4})-?(\d{3})/,De),rn=xe(Ne),on=Ce(Ve,$e,qe),sn=Ce(Pe,$e,qe),an=Ce(Ie,$e),un=Ce($e,qe),cn=xe(/(\d{4})-(\d\d)-(\d\d)/,Me),ln=xe(Re),hn=Ce(Ve,$e,qe,Ue),fn=Ce($e,qe,Ue),dn={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},pn=Object.assign({years:{months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6}},dn),yn=Object.assign({years:{months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3}},dn),mn=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],vn=mn.slice(0).reverse();function gn(t,e,n){void 0===n&&(n=!1);var r={values:n?e.values:Object.assign({},t.values,e.values||{}),loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy};return new wn(r)}function _n(t,e,n,r,i){var o,s=t[i][n],a=e[n]/s,u=Math.sign(a)!==Math.sign(r[i])&&0!==r[i]&&Math.abs(a)<=1?(o=a)<0?Math.floor(o):Math.ceil(o):Math.trunc(a);r[i]+=u,e[n]-=u*s}function bn(t,e){vn.reduce((function(n,r){return st(e[r])?n:(n&&_n(t,e,n,e,r),r)}),null)}var wn=function(){function t(t){var e="longterm"===t.conversionAccuracy||!1;this.values=t.values,this.loc=t.loc||Se.create(),this.conversionAccuracy=e?"longterm":"casual",this.invalid=t.invalid||null,this.matrix=e?yn:pn,this.isLuxonDuration=!0}t.fromMillis=function(e,n){return t.fromObject(Object.assign({milliseconds:e},n))},t.fromObject=function(e){if(null==e||"object"!=typeof e)throw new P("Duration.fromObject: argument expected to be an object, got "+(null===e?"null":typeof e));return new t({values:jt(e,t.normalizeUnit,["locale","numberingSystem","conversionAccuracy","zone"]),loc:Se.fromObject(e),conversionAccuracy:e.conversionAccuracy})},t.fromISO=function(e,n){var r=Te(e,[ze,He])[0];if(r){var i=Object.assign(r,n);return t.fromObject(i)}return t.invalid("unparsable",'the input "'+e+"\" can't be parsed as ISO 8601")},t.invalid=function(e,n){if(void 0===n&&(n=null),!e)throw new P("need to specify a reason the Duration is invalid");var r=e instanceof Qt?e:new Qt(e,n);if(ye.throwOnInvalid)throw new A(r);return new t({invalid:r})},t.normalizeUnit=function(t){var e={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t?t.toLowerCase():t];if(!e)throw new D(t);return e},t.isDuration=function(t){return t&&t.isLuxonDuration||!1};var e=t.prototype;return e.toFormat=function(t,e){void 0===e&&(e={});var n=Object.assign({},e,{floor:!1!==e.round&&!1!==e.floor});return this.isValid?Jt.create(this.loc,n).formatDurationFromString(this,t):"Invalid Duration"},e.toObject=function(t){if(void 0===t&&(t={}),!this.isValid)return{};var e=Object.assign({},this.values);return t.includeConfig&&(e.conversionAccuracy=this.conversionAccuracy,e.numberingSystem=this.loc.numberingSystem,e.locale=this.loc.locale),e},e.toISO=function(){if(!this.isValid)return null;var t="P";return 0!==this.years&&(t+=this.years+"Y"),0===this.months&&0===this.quarters||(t+=this.months+3*this.quarters+"M"),0!==this.weeks&&(t+=this.weeks+"W"),0!==this.days&&(t+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(t+="T"),0!==this.hours&&(t+=this.hours+"H"),0!==this.minutes&&(t+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(t+=_t(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===t&&(t+="T0S"),t},e.toJSON=function(){return this.toISO()},e.toString=function(){return this.toISO()},e.valueOf=function(){return this.as("milliseconds")},e.plus=function(t){if(!this.isValid)return this;for(var e=kn(t),n={},r=0,i=mn;r<i.length;r++){var o=i[r];(pt(e.values,o)||pt(this.values,o))&&(n[o]=e.get(o)+this.get(o))}return gn(this,{values:n},!0)},e.minus=function(t){if(!this.isValid)return this;var e=kn(t);return this.plus(e.negate())},e.mapUnits=function(t){if(!this.isValid)return this;for(var e={},n=0,r=Object.keys(this.values);n<r.length;n++){var i=r[n];e[i]=Tt(t(this.values[i],i))}return gn(this,{values:e},!0)},e.get=function(e){return this[t.normalizeUnit(e)]},e.set=function(e){return this.isValid?gn(this,{values:Object.assign(this.values,jt(e,t.normalizeUnit,[]))}):this},e.reconfigure=function(t){var e=void 0===t?{}:t,n=e.locale,r=e.numberingSystem,i=e.conversionAccuracy,o={loc:this.loc.clone({locale:n,numberingSystem:r})};return i&&(o.conversionAccuracy=i),gn(this,o)},e.as=function(t){return this.isValid?this.shiftTo(t).get(t):NaN},e.normalize=function(){if(!this.isValid)return this;var t=this.toObject();return bn(this.matrix,t),gn(this,{values:t},!0)},e.shiftTo=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!this.isValid)return this;if(0===n.length)return this;n=n.map((function(e){return t.normalizeUnit(e)}));var i,o={},s={},a=this.toObject();bn(this.matrix,a);for(var u=0,c=mn;u<c.length;u++){var l=c[u];if(n.indexOf(l)>=0){i=l;var h=0;for(var f in s)h+=this.matrix[f][l]*s[f],s[f]=0;at(a[l])&&(h+=a[l]);var d=Math.trunc(h);for(var p in o[l]=d,s[l]=h-d,a)mn.indexOf(p)>mn.indexOf(l)&&_n(this.matrix,a,p,o,l)}else at(a[l])&&(s[l]=a[l])}for(var y in s)0!==s[y]&&(o[i]+=y===i?s[y]:s[y]/this.matrix[i][y]);return gn(this,{values:o},!0).normalize()},e.negate=function(){if(!this.isValid)return this;for(var t={},e=0,n=Object.keys(this.values);e<n.length;e++){var r=n[e];t[r]=-this.values[r]}return gn(this,{values:t},!0)},e.equals=function(t){if(!this.isValid||!t.isValid)return!1;if(!this.loc.equals(t.loc))return!1;for(var e=0,n=mn;e<n.length;e++){var r=n[e];if(this.values[r]!==t.values[r])return!1}return!0},k(t,[{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"years",get:function(){return this.isValid?this.values.years||0:NaN}},{key:"quarters",get:function(){return this.isValid?this.values.quarters||0:NaN}},{key:"months",get:function(){return this.isValid?this.values.months||0:NaN}},{key:"weeks",get:function(){return this.isValid?this.values.weeks||0:NaN}},{key:"days",get:function(){return this.isValid?this.values.days||0:NaN}},{key:"hours",get:function(){return this.isValid?this.values.hours||0:NaN}},{key:"minutes",get:function(){return this.isValid?this.values.minutes||0:NaN}},{key:"seconds",get:function(){return this.isValid?this.values.seconds||0:NaN}},{key:"milliseconds",get:function(){return this.isValid?this.values.milliseconds||0:NaN}},{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),t}();function kn(t){if(at(t))return wn.fromMillis(t);if(wn.isDuration(t))return t;if("object"==typeof t)return wn.fromObject(t);throw new P("Unknown duration argument "+t+" of type "+typeof t)}var On="Invalid Interval";function En(t,e){return t&&t.isValid?e&&e.isValid?e<t?Sn.invalid("end before start","The end of an interval must be after its start, but you had start="+t.toISO()+" and end="+e.toISO()):null:Sn.invalid("missing or invalid end"):Sn.invalid("missing or invalid start")}var Sn=function(){function t(t){this.s=t.start,this.e=t.end,this.invalid=t.invalid||null,this.isLuxonInterval=!0}t.invalid=function(e,n){if(void 0===n&&(n=null),!e)throw new P("need to specify a reason the Interval is invalid");var r=e instanceof Qt?e:new Qt(e,n);if(ye.throwOnInvalid)throw new F(r);return new t({invalid:r})},t.fromDateTimes=function(e,n){var r=_r(e),i=_r(n),o=En(r,i);return null==o?new t({start:r,end:i}):o},t.after=function(e,n){var r=kn(n),i=_r(e);return t.fromDateTimes(i,i.plus(r))},t.before=function(e,n){var r=kn(n),i=_r(e);return t.fromDateTimes(i.minus(r),i)},t.fromISO=function(e,n){var r=(e||"").split("/",2),i=r[0],o=r[1];if(i&&o){var s=gr.fromISO(i,n),a=gr.fromISO(o,n);if(s.isValid&&a.isValid)return t.fromDateTimes(s,a);if(s.isValid){var u=wn.fromISO(o,n);if(u.isValid)return t.after(s,u)}else if(a.isValid){var c=wn.fromISO(i,n);if(c.isValid)return t.before(a,c)}}return t.invalid("unparsable",'the input "'+e+"\" can't be parsed asISO 8601")},t.isInterval=function(t){return t&&t.isLuxonInterval||!1};var e=t.prototype;return e.length=function(t){return void 0===t&&(t="milliseconds"),this.isValid?this.toDuration.apply(this,[t]).get(t):NaN},e.count=function(t){if(void 0===t&&(t="milliseconds"),!this.isValid)return NaN;var e=this.start.startOf(t),n=this.end.startOf(t);return Math.floor(n.diff(e,t).get(t))+1},e.hasSame=function(t){return!!this.isValid&&this.e.minus(1).hasSame(this.s,t)},e.isEmpty=function(){return this.s.valueOf()===this.e.valueOf()},e.isAfter=function(t){return!!this.isValid&&this.s>t},e.isBefore=function(t){return!!this.isValid&&this.e<=t},e.contains=function(t){return!!this.isValid&&this.s<=t&&this.e>t},e.set=function(e){var n=void 0===e?{}:e,r=n.start,i=n.end;return this.isValid?t.fromDateTimes(r||this.s,i||this.e):this},e.splitAt=function(){var e=this;if(!this.isValid)return[];for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var o=r.map(_r).filter((function(t){return e.contains(t)})).sort(),s=[],a=this.s,u=0;a<this.e;){var c=o[u]||this.e,l=+c>+this.e?this.e:c;s.push(t.fromDateTimes(a,l)),a=l,u+=1}return s},e.splitBy=function(e){var n=kn(e);if(!this.isValid||!n.isValid||0===n.as("milliseconds"))return[];for(var r,i,o=this.s,s=[];o<this.e;)i=+(r=o.plus(n))>+this.e?this.e:r,s.push(t.fromDateTimes(o,i)),o=i;return s},e.divideEqually=function(t){return this.isValid?this.splitBy(this.length()/t).slice(0,t):[]},e.overlaps=function(t){return this.e>t.s&&this.s<t.e},e.abutsStart=function(t){return!!this.isValid&&+this.e==+t.s},e.abutsEnd=function(t){return!!this.isValid&&+t.e==+this.s},e.engulfs=function(t){return!!this.isValid&&this.s<=t.s&&this.e>=t.e},e.equals=function(t){return!(!this.isValid||!t.isValid)&&this.s.equals(t.s)&&this.e.equals(t.e)},e.intersection=function(e){if(!this.isValid)return this;var n=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return n>r?null:t.fromDateTimes(n,r)},e.union=function(e){if(!this.isValid)return this;var n=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return t.fromDateTimes(n,r)},t.merge=function(t){var e=t.sort((function(t,e){return t.s-e.s})).reduce((function(t,e){var n=t[0],r=t[1];return r?r.overlaps(e)||r.abutsStart(e)?[n,r.union(e)]:[n.concat([r]),e]:[n,e]}),[[],null]),n=e[0],r=e[1];return r&&n.push(r),n},t.xor=function(e){var n,r=null,i=0,o=[],s=e.map((function(t){return[{time:t.s,type:"s"},{time:t.e,type:"e"}]})),a=(n=Array.prototype).concat.apply(n,s).sort((function(t,e){return t.time-e.time})),u=Array.isArray(a),c=0;for(a=u?a:a[Symbol.iterator]();;){var l;if(u){if(c>=a.length)break;l=a[c++]}else{if((c=a.next()).done)break;l=c.value}var h=l;1===(i+="s"===h.type?1:-1)?r=h.time:(r&&+r!=+h.time&&o.push(t.fromDateTimes(r,h.time)),r=null)}return t.merge(o)},e.difference=function(){for(var e=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.xor([this].concat(r)).map((function(t){return e.intersection(t)})).filter((function(t){return t&&!t.isEmpty()}))},e.toString=function(){return this.isValid?"["+this.s.toISO()+" \u2013 "+this.e.toISO()+")":On},e.toISO=function(t){return this.isValid?this.s.toISO(t)+"/"+this.e.toISO(t):On},e.toISODate=function(){return this.isValid?this.s.toISODate()+"/"+this.e.toISODate():On},e.toISOTime=function(t){return this.isValid?this.s.toISOTime(t)+"/"+this.e.toISOTime(t):On},e.toFormat=function(t,e){var n=(void 0===e?{}:e).separator,r=void 0===n?" \u2013 ":n;return this.isValid?""+this.s.toFormat(t)+r+this.e.toFormat(t):On},e.toDuration=function(t,e){return this.isValid?this.e.diff(this.s,t,e):wn.invalid(this.invalidReason)},e.mapEndpoints=function(e){return t.fromDateTimes(e(this.s),e(this.e))},k(t,[{key:"start",get:function(){return this.isValid?this.s:null}},{key:"end",get:function(){return this.isValid?this.e:null}},{key:"isValid",get:function(){return null===this.invalidReason}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),t}(),xn=function(){function t(){}return t.hasDST=function(t){void 0===t&&(t=ye.defaultZone);var e=gr.local().setZone(t).set({month:12});return!t.universal&&e.offset!==e.set({month:6}).offset},t.isValidIANAZone=function(t){return ie.isValidSpecifier(t)&&ie.isValidZone(t)},t.normalizeZone=function(t){return ue(t,ye.defaultZone)},t.months=function(t,e){void 0===t&&(t="long");var n=void 0===e?{}:e,r=n.locale,i=void 0===r?null:r,o=n.numberingSystem,s=void 0===o?null:o,a=n.outputCalendar,u=void 0===a?"gregory":a;return Se.create(i,s,u).months(t)},t.monthsFormat=function(t,e){void 0===t&&(t="long");var n=void 0===e?{}:e,r=n.locale,i=void 0===r?null:r,o=n.numberingSystem,s=void 0===o?null:o,a=n.outputCalendar,u=void 0===a?"gregory":a;return Se.create(i,s,u).months(t,!0)},t.weekdays=function(t,e){void 0===t&&(t="long");var n=void 0===e?{}:e,r=n.locale,i=void 0===r?null:r,o=n.numberingSystem,s=void 0===o?null:o;return Se.create(i,s,null).weekdays(t)},t.weekdaysFormat=function(t,e){void 0===t&&(t="long");var n=void 0===e?{}:e,r=n.locale,i=void 0===r?null:r,o=n.numberingSystem,s=void 0===o?null:o;return Se.create(i,s,null).weekdays(t,!0)},t.meridiems=function(t){var e=(void 0===t?{}:t).locale,n=void 0===e?null:e;return Se.create(n).meridiems()},t.eras=function(t,e){void 0===t&&(t="short");var n=(void 0===e?{}:e).locale,r=void 0===n?null:n;return Se.create(r,null,"gregory").eras(t)},t.features=function(){var t=!1,e=!1,n=!1,r=!1;if(ct()){t=!0,e=lt(),r=ht();try{n="America/New_York"===new Intl.DateTimeFormat("en",{timeZone:"America/New_York"}).resolvedOptions().timeZone}catch(i){n=!1}}return{intl:t,intlTokens:e,zones:n,relative:r}},t}();function Cn(t,e){var n=function(t){return t.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf()},r=n(e)-n(t);return Math.floor(wn.fromMillis(r).as("days"))}var Tn={arab:"[\u0660-\u0669]",arabext:"[\u06f0-\u06f9]",bali:"[\u1b50-\u1b59]",beng:"[\u09e6-\u09ef]",deva:"[\u0966-\u096f]",fullwide:"[\uff10-\uff19]",gujr:"[\u0ae6-\u0aef]",hanidec:"[\u3007|\u4e00|\u4e8c|\u4e09|\u56db|\u4e94|\u516d|\u4e03|\u516b|\u4e5d]",khmr:"[\u17e0-\u17e9]",knda:"[\u0ce6-\u0cef]",laoo:"[\u0ed0-\u0ed9]",limb:"[\u1946-\u194f]",mlym:"[\u0d66-\u0d6f]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0b66-\u0b6f]",tamldec:"[\u0be6-\u0bef]",telu:"[\u0c66-\u0c6f]",thai:"[\u0e50-\u0e59]",tibt:"[\u0f20-\u0f29]",latn:"\\d"},jn={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Fn=Tn.hanidec.replace(/[\[|\]]/g,"").split("");function An(t,e){var n=t.numberingSystem;return void 0===e&&(e=""),new RegExp(""+Tn[n||"latn"]+e)}function Nn(t,e){return void 0===e&&(e=function(t){return t}),{regex:t,deser:function(t){var n=t[0];return e(function(t){var e=parseInt(t,10);if(isNaN(e)){e="";for(var n=0;n<t.length;n++){var r=t.charCodeAt(n);if(-1!==t[n].search(Tn.hanidec))e+=Fn.indexOf(t[n]);else for(var i in jn){var o=jn[i],s=o[0],a=o[1];r>=s&&r<=a&&(e+=r-s)}}return parseInt(e,10)}return e}(n))}}}function Dn(t){return t.replace(/\./,"\\.?")}function Pn(t){return t.replace(/\./,"").toLowerCase()}function In(t,e){return null===t?null:{regex:RegExp(t.map(Dn).join("|")),deser:function(n){var r=n[0];return t.findIndex((function(t){return Pn(r)===Pn(t)}))+e}}}function Rn(t,e){return{regex:t,deser:function(t){return Ct(t[1],t[2])},groups:e}}function Mn(t){return{regex:t,deser:function(t){return t[0]}}}var Ln={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"}},Vn=null;function $n(t,e,n){var r=function(t,e){var n;return(n=Array.prototype).concat.apply(n,t.map((function(t){return function(t,e){if(t.literal)return t;var n=Jt.macroTokenToFormatOpts(t.val);if(!n)return t;var r=Jt.create(e,n).formatDateTimeParts((Vn||(Vn=gr.fromMillis(1555555555555)),Vn)).map((function(t){return function(t,e,n){var r=t.type,i=t.value;if("literal"===r)return{literal:!0,val:i};var o=n[r],s=Ln[r];return"object"==typeof s&&(s=s[o]),s?{literal:!1,val:s}:void 0}(t,0,n)}));return r.includes(void 0)?t:r}(t,e)})))}(Jt.parseFormat(n),t),i=r.map((function(e){return n=e,i=An(r=t),o=An(r,"{2}"),s=An(r,"{3}"),a=An(r,"{4}"),u=An(r,"{6}"),c=An(r,"{1,2}"),l=An(r,"{1,3}"),h=An(r,"{1,6}"),f=An(r,"{1,9}"),d=An(r,"{2,4}"),p=An(r,"{4,6}"),y=function(t){return{regex:RegExp((e=t.val,e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:function(t){return t[0]},literal:!0};var e},(m=function(t){if(n.literal)return y(t);switch(t.val){case"G":return In(r.eras("short",!1),0);case"GG":return In(r.eras("long",!1),0);case"y":return Nn(h);case"yy":return Nn(d,St);case"yyyy":return Nn(a);case"yyyyy":return Nn(p);case"yyyyyy":return Nn(u);case"M":return Nn(c);case"MM":return Nn(o);case"MMM":return In(r.months("short",!0,!1),1);case"MMMM":return In(r.months("long",!0,!1),1);case"L":return Nn(c);case"LL":return Nn(o);case"LLL":return In(r.months("short",!1,!1),1);case"LLLL":return In(r.months("long",!1,!1),1);case"d":return Nn(c);case"dd":return Nn(o);case"o":return Nn(l);case"ooo":return Nn(s);case"HH":return Nn(o);case"H":return Nn(c);case"hh":return Nn(o);case"h":return Nn(c);case"mm":return Nn(o);case"m":case"q":return Nn(c);case"qq":return Nn(o);case"s":return Nn(c);case"ss":return Nn(o);case"S":return Nn(l);case"SSS":return Nn(s);case"u":return Mn(f);case"a":return In(r.meridiems(),0);case"kkkk":return Nn(a);case"kk":return Nn(d,St);case"W":return Nn(c);case"WW":return Nn(o);case"E":case"c":return Nn(i);case"EEE":return In(r.weekdays("short",!1,!1),1);case"EEEE":return In(r.weekdays("long",!1,!1),1);case"ccc":return In(r.weekdays("short",!0,!1),1);case"cccc":return In(r.weekdays("long",!0,!1),1);case"Z":case"ZZ":return Rn(new RegExp("([+-]"+c.source+")(?::("+o.source+"))?"),2);case"ZZZ":return Rn(new RegExp("([+-]"+c.source+")("+o.source+")?"),2);case"z":return Mn(/[a-z_+-/]{1,256}?/i);default:return y(t)}}(n)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"}).token=n,m;var n,r,i,o,s,a,u,c,l,h,f,d,p,y,m})),o=i.find((function(t){return t.invalidReason}));if(o)return{input:e,tokens:r,invalidReason:o.invalidReason};var s=function(t){return["^"+t.map((function(t){return t.regex})).reduce((function(t,e){return t+"("+e.source+")"}),"")+"$",t]}(i),a=s[0],u=s[1],c=RegExp(a,"i"),l=function(t,e,n){var r=t.match(e);if(r){var i={},o=1;for(var s in n)if(pt(n,s)){var a=n[s],u=a.groups?a.groups+1:1;!a.literal&&a.token&&(i[a.token.val[0]]=a.deser(r.slice(o,o+u))),o+=u}return[r,i]}return[r,{}]}(e,c,u),h=l[0],f=l[1],d=f?function(t){var e;return e=st(t.Z)?st(t.z)?null:ie.create(t.z):new se(t.Z),st(t.q)||(t.M=3*(t.q-1)+1),st(t.h)||(t.h<12&&1===t.a?t.h+=12:12===t.h&&0===t.a&&(t.h=0)),0===t.G&&t.y&&(t.y=-t.y),st(t.u)||(t.S=gt(t.u)),[Object.keys(t).reduce((function(e,n){var r=function(t){switch(t){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}}(n);return r&&(e[r]=t[n]),e}),{}),e]}(f):[null,null];return{input:e,tokens:r,regex:c,rawMatches:h,matches:f,result:d[0],zone:d[1]}}var qn=[0,31,59,90,120,151,181,212,243,273,304,334],Un=[0,31,60,91,121,152,182,213,244,274,305,335];function zn(t,e){return new Qt("unit out of range","you specified "+e+" (of type "+typeof e+") as a "+t+", which is invalid")}function Hn(t,e,n){var r=new Date(Date.UTC(t,e-1,n)).getUTCDay();return 0===r?7:r}function Bn(t,e,n){return n+(bt(t)?Un:qn)[e-1]}function Zn(t,e){var n=bt(t)?Un:qn,r=n.findIndex((function(t){return t<e}));return{month:r+1,day:e-n[r]}}function Gn(t){var e,n=t.year,r=t.month,i=t.day,o=Bn(n,r,i),s=Hn(n,r,i),a=Math.floor((o-s+10)/7);return a<1?a=Et(e=n-1):a>Et(n)?(e=n+1,a=1):e=n,Object.assign({weekYear:e,weekNumber:a,weekday:s},At(t))}function Wn(t){var e,n=t.weekYear,r=t.weekNumber,i=t.weekday,o=Hn(n,1,4),s=wt(n),a=7*r+i-o-3;a<1?a+=wt(e=n-1):a>s?(e=n+1,a-=wt(n)):e=n;var u=Zn(e,a),c=u.month,l=u.day;return Object.assign({year:e,month:c,day:l},At(t))}function Jn(t){var e=t.year,n=Bn(e,t.month,t.day);return Object.assign({year:e,ordinal:n},At(t))}function Qn(t){var e=t.year,n=Zn(e,t.ordinal),r=n.month,i=n.day;return Object.assign({year:e,month:r,day:i},At(t))}function Yn(t){var e=ut(t.year),n=yt(t.month,1,12),r=yt(t.day,1,kt(t.year,t.month));return e?n?!r&&zn("day",t.day):zn("month",t.month):zn("year",t.year)}function Xn(t){var e=t.hour,n=t.minute,r=t.second,i=t.millisecond,o=yt(e,0,23)||24===e&&0===n&&0===r&&0===i,s=yt(n,0,59),a=yt(r,0,59),u=yt(i,0,999);return o?s?a?!u&&zn("millisecond",i):zn("second",r):zn("minute",n):zn("hour",e)}function Kn(t){return new Qt("unsupported zone",'the zone "'+t.name+'" is not supported')}function tr(t){return null===t.weekData&&(t.weekData=Gn(t.c)),t.weekData}function er(t,e){var n={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new gr(Object.assign({},n,e,{old:n}))}function nr(t,e,n){var r=t-60*e*1e3,i=n.offset(r);if(e===i)return[r,e];r-=60*(i-e)*1e3;var o=n.offset(r);return i===o?[r,i]:[t-60*Math.min(i,o)*1e3,Math.max(i,o)]}function rr(t,e){var n=new Date(t+=60*e*1e3);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function ir(t,e,n){return nr(Ot(t),e,n)}function or(t,e){var n,r=Object.keys(e.values);-1===r.indexOf("milliseconds")&&r.push("milliseconds"),e=(n=e).shiftTo.apply(n,r);var i=t.o,o=t.c.year+e.years,s=t.c.month+e.months+3*e.quarters,a=Object.assign({},t.c,{year:o,month:s,day:Math.min(t.c.day,kt(o,s))+e.days+7*e.weeks}),u=wn.fromObject({hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),c=nr(Ot(a),i,t.zone),l=c[0],h=c[1];return 0!==u&&(l+=u,h=t.zone.offset(l)),{ts:l,o:h}}function sr(t,e,n,r,i){var o=n.setZone,s=n.zone;if(t&&0!==Object.keys(t).length){var a=e||s,u=gr.fromObject(Object.assign(t,n,{zone:a,setZone:void 0}));return o?u:u.setZone(s)}return gr.invalid(new Qt("unparsable",'the input "'+i+"\" can't be parsed as "+r))}function ar(t,e){return t.isValid?Jt.create(Se.create("en-US"),{allowZ:!0,forceSimple:!0}).formatDateTimeFromString(t,e):null}function ur(t,e){var n=e.suppressSeconds,r=void 0!==n&&n,i=e.suppressMilliseconds,o=void 0!==i&&i,s=e.includeOffset,a=e.includeZone,u=void 0!==a&&a,c=e.spaceZone,l=void 0!==c&&c,h="HH:mm";return r&&0===t.second&&0===t.millisecond||(h+=":ss",o&&0===t.millisecond||(h+=".SSS")),(u||s)&&l&&(h+=" "),u?h+="z":s&&(h+="ZZ"),ar(t,h)}var cr={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},lr={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},hr={ordinal:1,hour:0,minute:0,second:0,millisecond:0},fr=["year","month","day","hour","minute","second","millisecond"],dr=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],pr=["year","ordinal","hour","minute","second","millisecond"];function yr(t){var e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new D(t);return e}function mr(t,e){for(var n=0,r=fr;n<r.length;n++){var i=r[n];st(t[i])&&(t[i]=cr[i])}var o=Yn(t)||Xn(t);if(o)return gr.invalid(o);var s=ye.now(),a=ir(t,e.offset(s),e),u=a[0],c=a[1];return new gr({ts:u,zone:e,o:c})}function vr(t,e,n){var r=!!st(n.round)||n.round,i=function(t,i){return t=_t(t,r||n.calendary?0:2,!0),e.loc.clone(n).relFormatter(n).format(t,i)},o=function(r){return n.calendary?e.hasSame(t,r)?0:e.startOf(r).diff(t.startOf(r),r).get(r):e.diff(t,r).get(r)};if(n.unit)return i(o(n.unit),n.unit);var s=n.units,a=Array.isArray(s),u=0;for(s=a?s:s[Symbol.iterator]();;){var c;if(a){if(u>=s.length)break;c=s[u++]}else{if((u=s.next()).done)break;c=u.value}var l=c,h=o(l);if(Math.abs(h)>=1)return i(h,l)}return i(0,n.units[n.units.length-1])}var gr=function(){function t(t){var e=t.zone||ye.defaultZone,n=t.invalid||(Number.isNaN(t.ts)?new Qt("invalid input"):null)||(e.isValid?null:Kn(e));this.ts=st(t.ts)?ye.now():t.ts;var r=null,i=null;if(!n)if(t.old&&t.old.ts===this.ts&&t.old.zone.equals(e)){var o=[t.old.c,t.old.o];r=o[0],i=o[1]}else r=rr(this.ts,e.offset(this.ts)),r=(n=Number.isNaN(r.year)?new Qt("invalid input"):null)?null:r,i=n?null:e.offset(this.ts);this._zone=e,this.loc=t.loc||Se.create(),this.invalid=n,this.weekData=null,this.c=r,this.o=i,this.isLuxonDateTime=!0}t.local=function(e,n,r,i,o,s,a){return st(e)?new t({ts:ye.now()}):mr({year:e,month:n,day:r,hour:i,minute:o,second:s,millisecond:a},ye.defaultZone)},t.utc=function(e,n,r,i,o,s,a){return st(e)?new t({ts:ye.now(),zone:se.utcInstance}):mr({year:e,month:n,day:r,hour:i,minute:o,second:s,millisecond:a},se.utcInstance)},t.fromJSDate=function(e,n){void 0===n&&(n={});var r,i=(r=e,"[object Date]"===Object.prototype.toString.call(r)?e.valueOf():NaN);if(Number.isNaN(i))return t.invalid("invalid input");var o=ue(n.zone,ye.defaultZone);return o.isValid?new t({ts:i,zone:o,loc:Se.fromObject(n)}):t.invalid(Kn(o))},t.fromMillis=function(e,n){if(void 0===n&&(n={}),at(e))return e<-864e13||e>864e13?t.invalid("Timestamp out of range"):new t({ts:e,zone:ue(n.zone,ye.defaultZone),loc:Se.fromObject(n)});throw new P("fromMillis requires a numerical input")},t.fromSeconds=function(e,n){if(void 0===n&&(n={}),at(e))return new t({ts:1e3*e,zone:ue(n.zone,ye.defaultZone),loc:Se.fromObject(n)});throw new P("fromSeconds requires a numerical input")},t.fromObject=function(e){var n=ue(e.zone,ye.defaultZone);if(!n.isValid)return t.invalid(Kn(n));var r=ye.now(),i=n.offset(r),o=jt(e,yr,["zone","locale","outputCalendar","numberingSystem"]),s=!st(o.ordinal),a=!st(o.year),u=!st(o.month)||!st(o.day),c=a||u,l=o.weekYear||o.weekNumber,h=Se.fromObject(e);if((c||s)&&l)throw new N("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(u&&s)throw new N("Can't mix ordinal dates with month/day");var f,d,p=l||o.weekday&&!c,y=rr(r,i);p?(f=dr,d=lr,y=Gn(y)):s?(f=pr,d=hr,y=Jn(y)):(f=fr,d=cr);var m=!1,v=f,g=Array.isArray(v),_=0;for(v=g?v:v[Symbol.iterator]();;){var b;if(g){if(_>=v.length)break;b=v[_++]}else{if((_=v.next()).done)break;b=_.value}var w=b;st(o[w])?o[w]=m?d[w]:y[w]:m=!0}var k=(p?function(t){var e=ut(t.weekYear),n=yt(t.weekNumber,1,Et(t.weekYear)),r=yt(t.weekday,1,7);return e?n?!r&&zn("weekday",t.weekday):zn("week",t.week):zn("weekYear",t.weekYear)}(o):s?function(t){var e=ut(t.year),n=yt(t.ordinal,1,wt(t.year));return e?!n&&zn("ordinal",t.ordinal):zn("year",t.year)}(o):Yn(o))||Xn(o);if(k)return t.invalid(k);var O=ir(p?Wn(o):s?Qn(o):o,i,n),E=new t({ts:O[0],zone:n,o:O[1],loc:h});return o.weekday&&c&&e.weekday!==E.weekday?t.invalid("mismatched weekday","you can't specify both a weekday of "+o.weekday+" and a date of "+E.toISO()):E},t.fromISO=function(t,e){void 0===e&&(e={});var n=Te(t,[tn,on],[en,sn],[nn,an],[rn,un]);return sr(n[0],n[1],e,"ISO 8601",t)},t.fromRFC2822=function(t,e){void 0===e&&(e={});var n=Te(function(t){return t.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(t),[Ge,We]);return sr(n[0],n[1],e,"RFC 2822",t)},t.fromHTTP=function(t,e){void 0===e&&(e={});var n=Te(t,[Je,Xe],[Qe,Xe],[Ye,Ke]);return sr(n[0],n[1],e,"HTTP",e)},t.fromFormat=function(e,n,r){if(void 0===r&&(r={}),st(e)||st(n))throw new P("fromFormat requires an input string and a format");var i=r,o=i.locale,s=void 0===o?null:o,a=i.numberingSystem,u=void 0===a?null:a,c=function(t,e,n){var r=$n(t,e,n);return[r.result,r.zone,r.invalidReason]}(Se.fromOpts({locale:s,numberingSystem:u,defaultToEN:!0}),e,n),l=c[0],h=c[1],f=c[2];return f?t.invalid(f):sr(l,h,r,"format "+n,e)},t.fromString=function(e,n,r){return void 0===r&&(r={}),t.fromFormat(e,n,r)},t.fromSQL=function(t,e){void 0===e&&(e={});var n=Te(t,[cn,hn],[ln,fn]);return sr(n[0],n[1],e,"SQL",t)},t.invalid=function(e,n){if(void 0===n&&(n=null),!e)throw new P("need to specify a reason the DateTime is invalid");var r=e instanceof Qt?e:new Qt(e,n);if(ye.throwOnInvalid)throw new j(r);return new t({invalid:r})},t.isDateTime=function(t){return t&&t.isLuxonDateTime||!1};var e=t.prototype;return e.get=function(t){return this[t]},e.resolvedLocaleOpts=function(t){void 0===t&&(t={});var e=Jt.create(this.loc.clone(t),t).resolvedOptions(this);return{locale:e.locale,numberingSystem:e.numberingSystem,outputCalendar:e.calendar}},e.toUTC=function(t,e){return void 0===t&&(t=0),void 0===e&&(e={}),this.setZone(se.instance(t),e)},e.toLocal=function(){return this.setZone(ye.defaultZone)},e.setZone=function(e,n){var r=void 0===n?{}:n,i=r.keepLocalTime,o=void 0!==i&&i,s=r.keepCalendarTime,a=void 0!==s&&s;if((e=ue(e,ye.defaultZone)).equals(this.zone))return this;if(e.isValid){var u=this.ts;if(o||a){var c=this.o-e.offset(this.ts);u=ir(this.toObject(),c,e)[0]}return er(this,{ts:u,zone:e})}return t.invalid(Kn(e))},e.reconfigure=function(t){var e=void 0===t?{}:t,n=e.locale,r=e.numberingSystem,i=e.outputCalendar;return er(this,{loc:this.loc.clone({locale:n,numberingSystem:r,outputCalendar:i})})},e.setLocale=function(t){return this.reconfigure({locale:t})},e.set=function(t){if(!this.isValid)return this;var e,n=jt(t,yr,[]);st(n.weekYear)&&st(n.weekNumber)&&st(n.weekday)?st(n.ordinal)?(e=Object.assign(this.toObject(),n),st(n.day)&&(e.day=Math.min(kt(e.year,e.month),e.day))):e=Qn(Object.assign(Jn(this.c),n)):e=Wn(Object.assign(Gn(this.c),n));var r=ir(e,this.o,this.zone);return er(this,{ts:r[0],o:r[1]})},e.plus=function(t){return this.isValid?er(this,or(this,kn(t))):this},e.minus=function(t){return this.isValid?er(this,or(this,kn(t).negate())):this},e.startOf=function(t){if(!this.isValid)return this;var e={},n=wn.normalizeUnit(t);switch(n){case"years":e.month=1;case"quarters":case"months":e.day=1;case"weeks":case"days":e.hour=0;case"hours":e.minute=0;case"minutes":e.second=0;case"seconds":e.millisecond=0}if("weeks"===n&&(e.weekday=1),"quarters"===n){var r=Math.ceil(this.month/3);e.month=3*(r-1)+1}return this.set(e)},e.endOf=function(t){var e;return this.isValid?this.plus((e={},e[t]=1,e)).startOf(t).minus(1):this},e.toFormat=function(t,e){return void 0===e&&(e={}),this.isValid?Jt.create(this.loc.redefaultToEN(e)).formatDateTimeFromString(this,t):"Invalid DateTime"},e.toLocaleString=function(t){return void 0===t&&(t=V),this.isValid?Jt.create(this.loc.clone(t),t).formatDateTime(this):"Invalid DateTime"},e.toLocaleParts=function(t){return void 0===t&&(t={}),this.isValid?Jt.create(this.loc.clone(t),t).formatDateTimeParts(this):[]},e.toISO=function(t){return void 0===t&&(t={}),this.isValid?this.toISODate()+"T"+this.toISOTime(t):null},e.toISODate=function(){var t="yyyy-MM-dd";return this.year>9999&&(t="+"+t),ar(this,t)},e.toISOWeekDate=function(){return ar(this,"kkkk-'W'WW-c")},e.toISOTime=function(t){var e=void 0===t?{}:t,n=e.suppressMilliseconds,r=void 0!==n&&n,i=e.suppressSeconds,o=void 0!==i&&i,s=e.includeOffset;return ur(this,{suppressSeconds:o,suppressMilliseconds:r,includeOffset:void 0===s||s})},e.toRFC2822=function(){return ar(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ")},e.toHTTP=function(){return ar(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")},e.toSQLDate=function(){return ar(this,"yyyy-MM-dd")},e.toSQLTime=function(t){var e=void 0===t?{}:t,n=e.includeOffset,r=void 0===n||n,i=e.includeZone;return ur(this,{includeOffset:r,includeZone:void 0!==i&&i,spaceZone:!0})},e.toSQL=function(t){return void 0===t&&(t={}),this.isValid?this.toSQLDate()+" "+this.toSQLTime(t):null},e.toString=function(){return this.isValid?this.toISO():"Invalid DateTime"},e.valueOf=function(){return this.toMillis()},e.toMillis=function(){return this.isValid?this.ts:NaN},e.toSeconds=function(){return this.isValid?this.ts/1e3:NaN},e.toJSON=function(){return this.toISO()},e.toBSON=function(){return this.toJSDate()},e.toObject=function(t){if(void 0===t&&(t={}),!this.isValid)return{};var e=Object.assign({},this.c);return t.includeConfig&&(e.outputCalendar=this.outputCalendar,e.numberingSystem=this.loc.numberingSystem,e.locale=this.loc.locale),e},e.toJSDate=function(){return new Date(this.isValid?this.ts:NaN)},e.diff=function(t,e,n){if(void 0===e&&(e="milliseconds"),void 0===n&&(n={}),!this.isValid||!t.isValid)return wn.invalid(this.invalid||t.invalid,"created by diffing an invalid DateTime");var r,i=Object.assign({locale:this.locale,numberingSystem:this.numberingSystem},n),o=(r=e,Array.isArray(r)?r:[r]).map(wn.normalizeUnit),s=t.valueOf()>this.valueOf(),a=function(t,e,n,r){var i,o=function(t,e,n){for(var r,i,o={},s=0,a=[["years",function(t,e){return e.year-t.year}],["months",function(t,e){return e.month-t.month+12*(e.year-t.year)}],["weeks",function(t,e){var n=Cn(t,e);return(n-n%7)/7}],["days",Cn]];s<a.length;s++){var u=a[s],c=u[0],l=u[1];if(n.indexOf(c)>=0){var h;r=c;var f,d=l(t,e);(i=t.plus(((h={})[c]=d,h)))>e?(t=t.plus(((f={})[c]=d-1,f)),d-=1):t=i,o[c]=d}}return[t,o,i,r]}(t,e,n),s=o[0],a=o[1],u=o[2],c=o[3],l=e-s,h=n.filter((function(t){return["hours","minutes","seconds","milliseconds"].indexOf(t)>=0}));0===h.length&&(u<e&&(u=s.plus(((i={})[c]=1,i))),u!==s&&(a[c]=(a[c]||0)+l/(u-s)));var f,d=wn.fromObject(Object.assign(a,r));return h.length>0?(f=wn.fromMillis(l,r)).shiftTo.apply(f,h).plus(d):d}(s?this:t,s?t:this,o,i);return s?a.negate():a},e.diffNow=function(e,n){return void 0===e&&(e="milliseconds"),void 0===n&&(n={}),this.diff(t.local(),e,n)},e.until=function(t){return this.isValid?Sn.fromDateTimes(this,t):this},e.hasSame=function(t,e){if(!this.isValid)return!1;if("millisecond"===e)return this.valueOf()===t.valueOf();var n=t.valueOf();return this.startOf(e)<=n&&n<=this.endOf(e)},e.equals=function(t){return this.isValid&&t.isValid&&this.valueOf()===t.valueOf()&&this.zone.equals(t.zone)&&this.loc.equals(t.loc)},e.toRelative=function(e){if(void 0===e&&(e={}),!this.isValid)return null;var n=e.base||t.fromObject({zone:this.zone}),r=e.padding?this<n?-e.padding:e.padding:0;return vr(n,this.plus(r),Object.assign(e,{numeric:"always",units:["years","months","days","hours","minutes","seconds"]}))},e.toRelativeCalendar=function(e){return void 0===e&&(e={}),this.isValid?vr(e.base||t.fromObject({zone:this.zone}),this,Object.assign(e,{numeric:"auto",units:["years","months","days"],calendary:!0})):null},t.min=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!n.every(t.isDateTime))throw new P("min requires all arguments be DateTimes");return ft(n,(function(t){return t.valueOf()}),Math.min)},t.max=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!n.every(t.isDateTime))throw new P("max requires all arguments be DateTimes");return ft(n,(function(t){return t.valueOf()}),Math.max)},t.fromFormatExplain=function(t,e,n){void 0===n&&(n={});var r=n,i=r.locale,o=void 0===i?null:i,s=r.numberingSystem,a=void 0===s?null:s;return $n(Se.fromOpts({locale:o,numberingSystem:a,defaultToEN:!0}),t,e)},t.fromStringExplain=function(e,n,r){return void 0===r&&(r={}),t.fromFormatExplain(e,n,r)},k(t,[{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}},{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"outputCalendar",get:function(){return this.isValid?this.loc.outputCalendar:null}},{key:"zone",get:function(){return this._zone}},{key:"zoneName",get:function(){return this.isValid?this.zone.name:null}},{key:"year",get:function(){return this.isValid?this.c.year:NaN}},{key:"quarter",get:function(){return this.isValid?Math.ceil(this.c.month/3):NaN}},{key:"month",get:function(){return this.isValid?this.c.month:NaN}},{key:"day",get:function(){return this.isValid?this.c.day:NaN}},{key:"hour",get:function(){return this.isValid?this.c.hour:NaN}},{key:"minute",get:function(){return this.isValid?this.c.minute:NaN}},{key:"second",get:function(){return this.isValid?this.c.second:NaN}},{key:"millisecond",get:function(){return this.isValid?this.c.millisecond:NaN}},{key:"weekYear",get:function(){return this.isValid?tr(this).weekYear:NaN}},{key:"weekNumber",get:function(){return this.isValid?tr(this).weekNumber:NaN}},{key:"weekday",get:function(){return this.isValid?tr(this).weekday:NaN}},{key:"ordinal",get:function(){return this.isValid?Jn(this.c).ordinal:NaN}},{key:"monthShort",get:function(){return this.isValid?xn.months("short",{locale:this.locale})[this.month-1]:null}},{key:"monthLong",get:function(){return this.isValid?xn.months("long",{locale:this.locale})[this.month-1]:null}},{key:"weekdayShort",get:function(){return this.isValid?xn.weekdays("short",{locale:this.locale})[this.weekday-1]:null}},{key:"weekdayLong",get:function(){return this.isValid?xn.weekdays("long",{locale:this.locale})[this.weekday-1]:null}},{key:"offset",get:function(){return this.isValid?+this.o:NaN}},{key:"offsetNameShort",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}},{key:"offsetNameLong",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}},{key:"isOffsetFixed",get:function(){return this.isValid?this.zone.universal:null}},{key:"isInDST",get:function(){return!this.isOffsetFixed&&(this.offset>this.set({month:1}).offset||this.offset>this.set({month:5}).offset)}},{key:"isInLeapYear",get:function(){return bt(this.year)}},{key:"daysInMonth",get:function(){return kt(this.year,this.month)}},{key:"daysInYear",get:function(){return this.isValid?wt(this.year):NaN}},{key:"weeksInWeekYear",get:function(){return this.isValid?Et(this.weekYear):NaN}}],[{key:"DATE_SHORT",get:function(){return V}},{key:"DATE_MED",get:function(){return $}},{key:"DATE_FULL",get:function(){return q}},{key:"DATE_HUGE",get:function(){return U}},{key:"TIME_SIMPLE",get:function(){return z}},{key:"TIME_WITH_SECONDS",get:function(){return H}},{key:"TIME_WITH_SHORT_OFFSET",get:function(){return B}},{key:"TIME_WITH_LONG_OFFSET",get:function(){return Z}},{key:"TIME_24_SIMPLE",get:function(){return G}},{key:"TIME_24_WITH_SECONDS",get:function(){return W}},{key:"TIME_24_WITH_SHORT_OFFSET",get:function(){return J}},{key:"TIME_24_WITH_LONG_OFFSET",get:function(){return Q}},{key:"DATETIME_SHORT",get:function(){return Y}},{key:"DATETIME_SHORT_WITH_SECONDS",get:function(){return X}},{key:"DATETIME_MED",get:function(){return K}},{key:"DATETIME_MED_WITH_SECONDS",get:function(){return tt}},{key:"DATETIME_MED_WITH_WEEKDAY",get:function(){return et}},{key:"DATETIME_FULL",get:function(){return nt}},{key:"DATETIME_FULL_WITH_SECONDS",get:function(){return rt}},{key:"DATETIME_HUGE",get:function(){return it}},{key:"DATETIME_HUGE_WITH_SECONDS",get:function(){return ot}}]),t}();function _r(t){if(gr.isDateTime(t))return t;if(t&&t.valueOf&&at(t.valueOf()))return gr.fromJSDate(t);if(t&&"object"==typeof t)return gr.fromObject(t);throw new P("Unknown datetime argument: "+t+", of type "+typeof t)}b.DateTime=gr;var br={},wr="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(wr){var kr=new Uint8Array(16);br=function(){return wr(kr),kr}}else{var Or=new Array(16);br=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),Or[e]=t>>>((3&e)<<3)&255;return Or}}for(var Er=[],Sr=0;Sr<256;++Sr)Er[Sr]=(Sr+256).toString(16).substr(1);var xr=function(t,e,n){var r=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var i=(t=t||{}).random||(t.rng||br)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e)for(var o=0;o<16;++o)e[r+o]=i[o];return e||function(t,e){var n=e||0,r=Er;return[r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]]].join("")}(i)};const{DateTime:Cr}=b;const Tr=async function(t){const{body:e}=await t.get({endpoint:"/accounts/current"});return e},jr=async function(t,{identity:e,db:n,role:r,email:i}){return await t.post({identity:e,endpoint:`/db/${n}/grant`,query:{role:r,email:i}})},Fr=async function(t,{identity:e,db:n,email:r}){return await t.post({identity:e,endpoint:`/db/${n}/revoke`,query:{email:r}})},Ar=async function(t,{db:e,ns:n,stream:r}){await t.delete({endpoint:`/db/${e}/ns/${n}/streams/${r}/annotation`})},Nr=async function(t,{db:e,ns:n,stream:r}){try{const{body:i}=await t.get({endpoint:`/db/${e}/ns/${n}/streams/${r}/annotation`});return i}catch(i){if(i&&404===i.statusCode)return;if(i)throw i}},Dr=async function(t,{db:e,to:n}){await t.post({endpoint:`/db/${e}/clone?to=${n}`})},Pr=async function(t,{identity:e,db:n}){await t.put({identity:e,endpoint:"/db/"+n})},Ir=async function(t,{identity:e,db:n}){await t.delete({identity:e,endpoint:"/db/"+n})},Rr=async function(t,{db:e,ns:n,stream:r,from:i,after:o,to:s,until:a,types:u,limit:c,each:h}){const f=t.url({endpoint:`/db/${e}/events`,query:{ns:n,stream:r,types:u,from:i,after:o,to:s,until:a,limit:c,schema:"jsonapi"},headers:{accept:"text/event-stream"}}),d=new _(f,{headers:await t.auth()});let p,y;d.addEventListener("error",t=>{t.message?(d.close(),m.jobs.length=0,y(t)):d.close()});const m=new l;return d.addEventListener("message",t=>{!async function(t,e,n){m.run(async(r,i)=>{await e(t,n),i.success(),m.running||p()})}(JSON.parse(t.data),h,{cancel:async()=>{d.close(),m.jobs.length=0,p()}})}),new Promise((t,e)=>{p=t,y=e})},Mr=async function(t,{db:e,to:n}){await t.post({endpoint:`/db/${e}/rename?to=${n}`})},Lr=async function(t,{each:e}){const{body:n}=await t.get({endpoint:"/db"});for(const r of n)await e(r)},Vr=async function(t,{db:e,ns:n,stream:r,event:i}){await t.delete({endpoint:`/db/${e}/ns/${n}/streams/${r}/events/${i}`})},$r=async function(t,{identity:e,db:n,ns:r,stream:i,event:o}){let{body:s}=await t.get({identity:e,endpoint:`/db/${n}/ns/${r}/streams/${i}/events/${o}`});return s},qr=async function(t,{identity:e,db:n,ns:r}){await t.put({identity:e,endpoint:`/db/${n}/ns/${r}`})},Ur=async function(t,{db:e,ns:n}){await t.delete({endpoint:`/db/${e}/ns/${n}`})},zr=async function(t,{db:e,ns:n,from:r,after:i,to:o,until:s,types:a,limit:u,each:c}){const{body:l}=await t.get({endpoint:`/db/${e}/ns/${n}/events`,query:{types:a,from:r,after:i,to:o,until:s,limit:u,schema:"jsonapi"}});for(const h of l.data)await c(h);if(l.meta.cursor)return l.meta.cursor.after},Hr=async function(t,{db:e,ns:n,to:r}){await t.post({endpoint:`/db/${e}/ns/${n}/rename?to=${r}`})},Br=async function(t,{db:e,ns:n}){await t.delete({endpoint:`/db/${e}/ns/${n}/contents`})},Zr=async function(t,{db:e,each:n}){const{body:r}=await t.get({endpoint:`/db/${e}/ns`});for(const i of r)await n(i)},Gr=async function(t,{db:e,ns:n,stream:r,annotation:i}){await t.put({endpoint:`/db/${e}/ns/${n}/streams/${r}/annotation`,body:i})},Wr=async function(t,{db:e,ns:n,stream:r}){await t.delete({endpoint:`/db/${e}/ns/${n}/streams/${r}`})},Jr=async function(t,{db:e,ns:n,stream:r,from:i,after:o,to:s,until:a,types:u,limit:c,each:h}){const f=t.url({endpoint:`/db/${e}/ns/${n}/streams/${r}/events`,query:{types:u,from:i,after:o,to:s,until:a,limit:c,schema:"jsonapi"},headers:{accept:"text/event-stream"}}),d=new _(f,{headers:await t.auth()});let p,y;d.addEventListener("error",t=>{t.message?(d.close(),m.jobs.length=0,y(t)):d.close()});const m=new l;return d.addEventListener("message",t=>{!async function(t,e,n){m.run(async(r,i)=>{await e(t,n),i.success(),m.running||p()})}(JSON.parse(t.data),h,{cancel:async()=>{d.close(),m.jobs.length=0,p()}})}),new Promise((t,e)=>{p=t,y=e})},Qr=async function(t,{db:e,ns:n,stream:r,data:i,meta:o,id:s}){const a={meta:{tz:Cr.local().zoneName,...o,id:null!=s?s:xr()},data:null!=i?i:{}};return await t.put({endpoint:`/db/${e}/ns/${n}/streams/${r}/events/${a.meta.id}`,body:a}),`${e}.${n}.${r}.${a.meta.id}`},Yr=async function(t,{db:e,ns:n,each:r}){const{body:i}=await t.get({endpoint:n?`/db/${e}/ns/${n}/streams`:`/db/${e}/streams`});for(const o of i)await r(o)};var Xr={};function Kr(t){var e=this;if(e instanceof Kr||(e=new Kr),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)e.push(arguments[n]);return e}function ti(t,e){t.tail=new ni(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function ei(t,e){t.head=new ni(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function ni(t,e,n,r){if(!(this instanceof ni))return new ni(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}Xr=Kr,Kr.Node=ni,Kr.create=Kr,Kr.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null},Kr.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},Kr.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},Kr.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)ti(this,arguments[t]);return this.length},Kr.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)ei(this,arguments[t]);return this.length},Kr.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},Kr.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},Kr.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},Kr.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},Kr.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value},Kr.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&e<t;e++)n=n.prev;if(e===t&&null!==n)return n.value},Kr.prototype.map=function(t,e){e=e||this;for(var n=new Kr,r=this.head;null!==r;)n.push(t.call(e,r.value,this)),r=r.next;return n},Kr.prototype.mapReverse=function(t,e){e=e||this;for(var n=new Kr,r=this.tail;null!==r;)n.push(t.call(e,r.value,this)),r=r.prev;return n},Kr.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},Kr.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},Kr.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},Kr.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},Kr.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new Kr;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var r=0,i=this.head;null!==i&&r<t;r++)i=i.next;for(;null!==i&&r<e;r++,i=i.next)n.push(i.value);return n},Kr.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new Kr;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var r=this.length,i=this.tail;null!==i&&r>e;r--)i=i.prev;for(;null!==i&&r>t;r--,i=i.prev)n.push(i.value);return n},Kr.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this};try{!function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}(Kr)}catch(So){}const ri=Symbol("max"),ii=Symbol("length"),oi=Symbol("lengthCalculator"),si=Symbol("allowStale"),ai=Symbol("maxAge"),ui=Symbol("dispose"),ci=Symbol("noDisposeOnSet"),li=Symbol("lruList"),hi=Symbol("cache"),fi=Symbol("updateAgeOnGet"),di=()=>1,pi=(t,e,n)=>{const r=t[hi].get(e);if(r){const e=r.value;if(yi(t,e)){if(vi(t,r),!t[si])return}else n&&(t[fi]&&(r.value.now=Date.now()),t[li].unshiftNode(r));return e.value}},yi=(t,e)=>{if(!e||!e.maxAge&&!t[ai])return!1;const n=Date.now()-e.now;return e.maxAge?n>e.maxAge:t[ai]&&n>t[ai]},mi=t=>{if(t[ii]>t[ri])for(let e=t[li].tail;t[ii]>t[ri]&&null!==e;){const n=e.prev;vi(t,e),e=n}},vi=(t,e)=>{if(e){const n=e.value;t[ui]&&t[ui](n.key,n.value),t[ii]-=n.length,t[hi].delete(n.key),t[li].removeNode(e)}};class gi{constructor(t,e,n,r,i){this.key=t,this.value=e,this.length=n,this.now=r,this.maxAge=i||0}}const _i=(t,e,n,r)=>{let i=n.value;yi(t,i)&&(vi(t,n),t[si]||(i=void 0)),i&&e.call(r,i.value,i.key,t)};var bi=class{constructor(t,e){this.stream=t,this.id=e}get account(){return this.db.account}get db(){return this.ns.db}get ns(){return this.stream.ns}async destroy(){return this.account.api.destroyEvent({db:this.db.name,ns:this.ns.name,stream:this.stream.id,event:this.id})}async read(){return this.account.api.readEvent({db:this.db.name,ns:this.ns.name,stream:this.stream.id,event:this.id})}},wi={exports:{}};(function(t,e,n){!function(t){if("object"==typeof wi.exports)wi.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;"undefined"!=typeof window?n=window:void 0!==e?n=e:"undefined"!=typeof self&&(n=self),n.Promise=t()}}((function(){return function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof _dereq_&&_dereq_;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};e[s][0].call(l.exports,(function(t){return i(e[s][1][t]||t)}),l,l.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof _dereq_&&_dereq_,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){"use strict";e.exports=function(t){var e=t._SomePromiseArray;function n(t){var n=new e(t),r=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),r}t.any=function(t){return n(t)},t.prototype.any=function(){return n(this)}}},{}],2:[function(e,n,r){"use strict";var i;try{throw new Error}catch(l){i=l}var o=e("./schedule"),s=e("./queue");function a(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new s(16),this._normalQueue=new s(16),this._haveDrainedQueues=!1;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=o}function u(t){for(;t.length()>0;)c(t)}function c(t){var e=t.shift();if("function"!=typeof e)e._settlePromises();else{var n=t.shift(),r=t.shift();e.call(n,r)}}a.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},a.prototype.hasCustomScheduler=function(){return this._customScheduler},a.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},a.prototype.fatalError=function(e,n){n?(t.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),t.exit(2)):this.throwLater(e)},a.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout((function(){t(e)}),0);else try{this._schedule((function(){t(e)}))}catch(l){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},a.prototype.invokeLater=function(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()},a.prototype.invoke=function(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()},a.prototype.settlePromises=function(t){this._normalQueue._pushOne(t),this._queueTick()},a.prototype._drainQueues=function(){u(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,u(this._lateQueue)},a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},a.prototype._reset=function(){this._isTickUsed=!1},n.exports=a,n.exports.firstLineError=i},{"./queue":26,"./schedule":29}],3:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){var i=!1,o=function(t,e){this._reject(e)},s=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(o,o,null,this,t)},a=function(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)},u=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(o){i||(i=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var c=n(o),l=new t(e);l._propagateFrom(this,1);var h=this._target();if(l._setBoundTo(c),c instanceof t){var f={promiseRejectionQueued:!1,promise:l,target:h,bindingPromise:c};h._then(e,s,void 0,l,f),c._then(a,u,void 0,l,f),l._setOnCancel(c)}else l._resolveCallback(h);return l},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e,n){"use strict";var r;"undefined"!=typeof Promise&&(r=Promise);var i=t("./promise")();i.noConflict=function(){try{Promise===i&&(Promise=r)}catch(t){}return i},e.exports=i},{"./promise":22}],5:[function(t,e,n){"use strict";var r=Object.create;if(r){var i=r(null),o=r(null);i[" size"]=o[" size"]=0}e.exports=function(e){var n=t("./util"),r=n.canEvaluate;function i(t){return function(t,r){var i;if(null!=t&&(i=t[r]),"function"!=typeof i){var o="Object "+n.classString(t)+" has no method '"+n.toString(r)+"'";throw new e.TypeError(o)}return i}(t,this.pop()).apply(t,this)}function o(t){return t[this]}function s(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}n.isIdentifier,e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(i,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e;if("number"==typeof t)e=s;else if(r){var n=(void 0)(t);e=null!==n?n:o}else e=o;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util"),s=o.tryCatch,a=o.errorObj,u=e._async;e.prototype.break=e.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),u.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(o.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var r=s(t).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),u.throwLater(r.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),u.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),r=t("./es5").keys,i=n.tryCatch,o=n.errorObj;return function(t,s,a){return function(u){var c=a._boundValue();t:for(var l=0;l<t.length;++l){var h=t[l];if(h===Error||null!=h&&h.prototype instanceof Error){if(u instanceof h)return i(s).call(c,u)}else if("function"==typeof h){var f=i(h).call(c,u);if(f===o)return f;if(f)return i(s).call(c,u)}else if(n.isObject(u)){for(var d=r(h),p=0;p<d.length;++p){var y=d[p];if(h[y]!=u[y])continue t}return i(s).call(c,u)}}return e}}}},{"./es5":13,"./util":36}],8:[function(t,e,n){"use strict";e.exports=function(t){var e=!1,n=[];function r(){this._trace=new r.CapturedTrace(i())}function i(){var t=n.length-1;if(t>=0)return n[t]}return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},r.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},r.prototype._popContext=function(){if(void 0!==this._trace){var t=n.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},r.CapturedTrace=null,r.create=function(){if(e)return new r},r.deactivateLongStackTraces=function(){},r.activateLongStackTraces=function(){var n=t.prototype._pushContext,o=t.prototype._popContext,s=t._peekContext,a=t.prototype._peekContext,u=t.prototype._promiseCreated;r.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=o,t._peekContext=s,t.prototype._peekContext=a,t.prototype._promiseCreated=u,e=!1},e=!0,t.prototype._pushContext=r.prototype._pushContext,t.prototype._popContext=r.prototype._popContext,t._peekContext=t.prototype._peekContext=i,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},r}},{}],9:[function(e,n,r){"use strict";n.exports=function(n,r,i,o){var s,a,u,c,l=n._async,h=e("./errors").Warning,f=e("./util"),d=e("./es5"),p=f.canAttachTrace,y=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,m=/\((?:timers\.js):\d+:\d+\)/,v=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,g=null,_=null,b=!1,w=!(0==f.env("BLUEBIRD_DEBUG")),k=!(0==f.env("BLUEBIRD_WARNINGS")||!w&&!f.env("BLUEBIRD_WARNINGS")),O=!(0==f.env("BLUEBIRD_LONG_STACK_TRACES")||!w&&!f.env("BLUEBIRD_LONG_STACK_TRACES")),E=0!=f.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(k||!!f.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){var t=[];function e(){for(var e=0;e<t.length;++e)t[e]._notifyUnhandledRejection();r()}function r(){t.length=0}c=function(n){t.push(n),setTimeout(e,1)},d.defineProperty(n,"_unhandledRejectionCheck",{value:e}),d.defineProperty(n,"_unhandledRejectionClear",{value:r})}(),n.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},n.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),c(this))},n.prototype._notifyUnhandledRejectionIsHandled=function(){W("rejectionHandled",s,void 0,this)},n.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},n.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},n.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),W("unhandledRejection",a,t,this)}},n.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},n.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},n.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},n.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},n.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},n.prototype._warn=function(t,e,n){return H(t,e,n||this)},n.onPossiblyUnhandledRejection=function(t){var e=n._getContext();a=f.contextBind(e,t)},n.onUnhandledRejectionHandled=function(t){var e=n._getContext();s=f.contextBind(e,t)};var S=function(){};n.longStackTraces=function(){if(l.haveItemsQueued()&&!nt.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!nt.longStackTraces&&Q()){var t=n.prototype._captureStackTrace,e=n.prototype._attachExtraTrace,i=n.prototype._dereferenceTrace;nt.longStackTraces=!0,S=function(){if(l.haveItemsQueued()&&!nt.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");n.prototype._captureStackTrace=t,n.prototype._attachExtraTrace=e,n.prototype._dereferenceTrace=i,r.deactivateLongStackTraces(),nt.longStackTraces=!1},n.prototype._captureStackTrace=q,n.prototype._attachExtraTrace=U,n.prototype._dereferenceTrace=z,r.activateLongStackTraces()}},n.hasLongStackTraces=function(){return nt.longStackTraces&&Q()};var x={unhandledrejection:{before:function(){var t=f.global.onunhandledrejection;return f.global.onunhandledrejection=null,t},after:function(t){f.global.onunhandledrejection=t}},rejectionhandled:{before:function(){var t=f.global.onrejectionhandled;return f.global.onrejectionhandled=null,t},after:function(t){f.global.onrejectionhandled=t}}},C=function(){var t=function(t,e){if(!t)return!f.global.dispatchEvent(e);var n;try{return n=t.before(),!f.global.dispatchEvent(e)}finally{t.after(n)}};try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return f.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r=new CustomEvent(e,{detail:n,cancelable:!0});return d.defineProperty(r,"promise",{value:n.promise}),d.defineProperty(r,"reason",{value:n.reason}),t(x[e],r)}}return"function"==typeof Event?(e=new Event("CustomEvent"),f.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r=new Event(e,{cancelable:!0});return r.detail=n,d.defineProperty(r,"promise",{value:n.promise}),d.defineProperty(r,"reason",{value:n.reason}),t(x[e],r)}):((e=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),f.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!1,!0,n),t(x[e],r)})}catch(n){}return function(){return!1}}(),T=f.isNode?function(){return t.emit.apply(t,arguments)}:f.global?function(t){var e="on"+t.toLowerCase(),n=f.global[e];return!!n&&(n.apply(f.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function j(t,e){return{promise:e}}var F={promiseCreated:j,promiseFulfilled:j,promiseRejected:j,promiseResolved:j,promiseCancelled:j,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:j},A=function(t){var e=!1;try{e=T.apply(null,arguments)}catch(r){l.throwLater(r),e=!0}var n=!1;try{n=C(t,F[t].apply(null,arguments))}catch(r){l.throwLater(r),n=!0}return n||e};function N(){return!1}function D(t,e,n){var r=this;try{t(e,n,(function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+f.toString(t));r._attachCancellationCallback(t)}))}catch(i){return i}}function P(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?f.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function I(){return this._onCancelField}function R(t){this._onCancelField=t}function M(){this._cancellationParent=void 0,this._onCancelField=void 0}function L(t,e){if(0!=(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}n.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?n.longStackTraces():!t.longStackTraces&&n.hasLongStackTraces()&&S()),"warnings"in t){var e=t.warnings;nt.warnings=!!e,E=nt.warnings,f.isObject(e)&&"wForgottenReturn"in e&&(E=!!e.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!nt.cancellation){if(l.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");n.prototype._clearCancellationData=M,n.prototype._propagateFrom=L,n.prototype._onCancel=I,n.prototype._setOnCancel=R,n.prototype._attachCancellationCallback=P,n.prototype._execute=D,V=L,nt.cancellation=!0}if("monitoring"in t&&(t.monitoring&&!nt.monitoring?(nt.monitoring=!0,n.prototype._fireEvent=A):!t.monitoring&&nt.monitoring&&(nt.monitoring=!1,n.prototype._fireEvent=N)),"asyncHooks"in t&&f.nodeSupportsAsyncResource){var r=nt.asyncHooks,s=!!t.asyncHooks;r!==s&&(nt.asyncHooks=s,s?i():o())}return n},n.prototype._fireEvent=N,n.prototype._execute=function(t,e,n){try{t(e,n)}catch(r){return r}},n.prototype._onCancel=function(){},n.prototype._setOnCancel=function(t){},n.prototype._attachCancellationCallback=function(t){},n.prototype._captureStackTrace=function(){},n.prototype._attachExtraTrace=function(){},n.prototype._dereferenceTrace=function(){},n.prototype._clearCancellationData=function(){},n.prototype._propagateFrom=function(t,e){};var V=function(t,e){0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)};function $(){var t=this._boundTo;return void 0!==t&&t instanceof n?t.isFulfilled()?t.value():void 0:t}function q(){this._trace=new tt(this._peekContext())}function U(t,e){if(p(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=Z(t);f.notEnumerableProp(t,"stack",r.message+"\n"+r.stack.join("\n")),f.notEnumerableProp(t,"__stackCleaned__",!0)}}}function z(){this._trace=void 0}function H(t,e,r){if(nt.warnings){var i,o=new h(t);if(e)r._attachExtraTrace(o);else if(nt.longStackTraces&&(i=n._peekContext()))i.attachExtraTrace(o);else{var s=Z(o);o.stack=s.message+"\n"+s.stack.join("\n")}A("warning",o)||G(o,"",!0)}}function B(t){for(var e=[],n=0;n<t.length;++n){var r=t[n],i="    (No stack trace)"===r||g.test(r),o=i&&Y(r);i&&!o&&(b&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function Z(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||g.test(r))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:B(e)}}function G(t,e,n){if("undefined"!=typeof console){var r;if(f.isObject(t)){var i=t.stack;r=e+_(i,t)}else r=e+String(t);"function"==typeof u?u(r,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(r)}}function W(t,e,n,r){var i=!1;try{"function"==typeof e&&(i=!0,"rejectionHandled"===t?e(r):e(n,r))}catch(o){l.throwLater(o)}"unhandledRejection"===t?A(t,n,r)||i||G(n,"Unhandled rejection "):A(t,r)}function J(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{if(e=t&&"function"==typeof t.toString?t.toString():f.toString(t),/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(n){}0===e.length&&(e="(empty array)")}return"(<"+function(t){return t.length<41?t:t.substr(0,38)+"..."}(e)+">, no stack trace)"}function Q(){return"function"==typeof et}var Y=function(){return!1},X=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function K(t){var e=t.match(X);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}function tt(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);et(this,tt),e>32&&this.uncycle()}f.inherits(tt,Error),r.CapturedTrace=tt,tt.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],n={},r=0,i=this;void 0!==i;++r)e.push(i),i=i._parent;for(r=(t=this._length=r)-1;r>=0;--r){var o=e[r].stack;void 0===n[o]&&(n[o]=r)}for(r=0;r<t;++r){var s=n[e[r].stack];if(void 0!==s&&s!==r){s>0&&(e[s-1]._parent=void 0,e[s-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var a=r>0?e[r-1]:this;s<t-1?(a._parent=e[s+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var u=a._length+1,c=r-2;c>=0;--c)e[c]._length=u,u++;return}}}},tt.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=Z(t),n=e.message,r=[e.stack],i=this;void 0!==i;)r.push(B(i.stack.split("\n"))),i=i._parent;!function(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],i=e.length-1,o=e[i],s=-1,a=r.length-1;a>=0;--a)if(r[a]===o){s=a;break}for(a=s;a>=0;--a){var u=r[a];if(e[i]!==u)break;e.pop(),i--}e=r}}(r),function(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}(r),f.notEnumerableProp(t,"stack",function(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}(n,r)),f.notEnumerableProp(t,"__stackCleaned__",!0)}};var et=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():J(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,g=t,_=e;var n=Error.captureStackTrace;return Y=function(t){return y.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var r,i=new Error;if("string"==typeof i.stack&&i.stack.split("\n")[0].indexOf("stackDetection@")>=0)return g=/@/,_=e,b=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(o){r="stack"in o}return"stack"in i||!r||"number"!=typeof Error.stackTraceLimit?(_=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?J(e):e.toString()},null):(g=t,_=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(o){t.stack=o.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(u=function(t){console.warn(t)},f.isNode&&t.stderr.isTTY?u=function(t,e){var n=e?"\x1b[33m":"\x1b[31m";console.warn(n+t+"\x1b[0m\n")}:f.isNode||"string"!=typeof(new Error).stack||(u=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var nt={warnings:k,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return O&&n.longStackTraces(),{asyncHooks:function(){return nt.asyncHooks},longStackTraces:function(){return nt.longStackTraces},warnings:function(){return nt.warnings},cancellation:function(){return nt.cancellation},monitoring:function(){return nt.monitoring},propagateFromFunction:function(){return V},boundValueFunction:function(){return $},checkForgottenReturns:function(t,e,n,r,i){if(void 0===t&&null!==e&&E){if(void 0!==i&&i._returnedNonUndefined())return;if(0==(65535&r._bitField))return;n&&(n+=" ");var o="",s="";if(e._trace){for(var a=e._trace.stack.split("\n"),u=B(a),c=u.length-1;c>=0;--c){var l=u[c];if(!m.test(l)){var h=l.match(v);h&&(o="at "+h[1]+":"+h[2]+":"+h[3]+" ");break}}if(u.length>0){var f=u[0];for(c=0;c<a.length;++c)if(a[c]===f){c>0&&(s="\n"+a[c-1]);break}}}var d="a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+s;r._warn(d,!0,e)}},setBounds:function(t,e){if(Q()){for(var n,r,i=(t.stack||"").split("\n"),o=(e.stack||"").split("\n"),s=-1,a=-1,u=0;u<i.length;++u)if(c=K(i[u])){n=c.fileName,s=c.line;break}for(u=0;u<o.length;++u){var c;if(c=K(o[u])){r=c.fileName,a=c.line;break}}s<0||a<0||!n||!r||n!==r||s>=a||(Y=function(t){if(y.test(t))return!0;var e=K(t);return!!(e&&e.fileName===n&&s<=e.line&&e.line<=a)})}},warn:H,deprecated:function(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),H(n)},CapturedTrace:tt,fireDomEvent:C,fireGlobalEvent:T}}},{"./errors":12,"./es5":13,"./util":36}],10:[function(t,e,n){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1];return this.caught(t,(function(){throw e}))},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var r=arguments[1];return r instanceof t&&r.suppressUnhandledRejections(),this.caught(n,(function(){return r}))}}},{}],11:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.reduce,r=t.all;function i(){return r(this)}t.prototype.each=function(t){return n(this,t,e,0)._then(i,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return n(this,t,e,e)},t.each=function(t,r){return n(t,r,e,0)._then(i,void 0,void 0,t,void 0)},t.mapSeries=function(t,r){return n(t,r,e,e)}}},{}],12:[function(t,e,n){"use strict";var r,i,o=t("./es5"),s=o.freeze,a=t("./util"),u=a.inherits,c=a.notEnumerableProp;function l(t,e){function n(r){if(!(this instanceof n))return new n(r);c(this,"message","string"==typeof r?r:e),c(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return u(n,Error),n}var h=l("Warning","warning"),f=l("CancellationError","cancellation error"),d=l("TimeoutError","timeout error"),p=l("AggregateError","aggregate error");try{r=TypeError,i=RangeError}catch(b){r=l("TypeError","type error"),i=l("RangeError","range error")}for(var y="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),m=0;m<y.length;++m)"function"==typeof Array.prototype[y[m]]&&(p.prototype[y[m]]=Array.prototype[y[m]]);o.defineProperty(p.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),p.prototype.isOperational=!0;var v=0;function g(t){if(!(this instanceof g))return new g(t);c(this,"name","OperationalError"),c(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(c(this,"message",t.message),c(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}p.prototype.toString=function(){var t=Array(4*v+1).join(" "),e="\n"+t+"AggregateError of:\n";v++,t=Array(4*v+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=t+i[o];e+=(r=i.join("\n"))+"\n"}return v--,e},u(g,Error);var _=Error.__BluebirdErrorTypes__;_||(_=s({CancellationError:f,TimeoutError:d,OperationalError:g,RejectionError:g,AggregateError:p}),o.defineProperty(Error,"__BluebirdErrorTypes__",{value:_,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:r,RangeError:i,CancellationError:_.CancellationError,OperationalError:_.OperationalError,TimeoutError:_.TimeoutError,AggregateError:_.AggregateError,Warning:h}},{"./es5":13,"./util":36}],13:[function(t,e,n){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,s={}.constructor.prototype,a=function(t){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e};e.exports={isArray:function(t){try{return"[object Array]"===o.call(t)}catch(e){return!1}},keys:a,names:a,defineProperty:function(t,e,n){return t[e]=n.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(e){return s}},isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,i){return n(t,r,i,e)}}},{}],15:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),o=e.CancellationError,s=i.errorObj,a=t("./catch_filter")(r);function u(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function c(t){this.finallyHandler=t}function l(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function h(){return d.call(this,this.promise._target()._settledValue())}function f(t){if(!l(this,t))return s.e=t,s}function d(t){var i=this.promise,a=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?a.call(i._boundValue()):a.call(i._boundValue(),t);if(u===r)return u;if(void 0!==u){i._setReturnedNonUndefined();var d=n(u,i);if(d instanceof e){if(null!=this.cancelPromise){if(d._isCancelled()){var p=new o("late cancellation observer");return i._attachExtraTrace(p),s.e=p,s}d.isPending()&&d._attachCancellationCallback(new c(this))}return d._then(h,f,void 0,this,void 0)}}}return i.isRejected()?(l(this),s.e=t,s):(l(this),t)}return u.prototype.isFinallyHandler=function(){return 0===this.type},c.prototype._resultCancelled=function(){l(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,r){return"function"!=typeof t?this.then():this._then(n,r,void 0,new u(this,e,t),void 0)},e.prototype.lastly=e.prototype.finally=function(t){return this._passThrough(t,0,d,d)},e.prototype.tap=function(t){return this._passThrough(t,1,d)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,d);var r,o=new Array(n-1),s=0;for(r=0;r<n-1;++r){var u=arguments[r];if(!i.isObject(u))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+i.classString(u)));o[s++]=u}o.length=s;var c=arguments[r];return this._passThrough(a(o,c,this),1,void 0,d)},u}},{"./catch_filter":7,"./util":36}],16:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=t("./errors").TypeError,u=t("./util"),c=u.errorObj,l=u.tryCatch,h=[];function f(t,n,i,o){if(s.cancellation()){var a=new e(r),u=this._finallyPromise=new e(r);this._promise=a.lastly((function(){return u})),a._captureStackTrace(),a._setOnCancel(this)}else(this._promise=new e(r))._captureStackTrace();this._stack=o,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(h):h,this._yieldedPromise=null,this._cancellationPhase=!1}u.inherits(f,o),f.prototype._isResolved=function(){return null===this._promise},f.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},f.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=l(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),t=l(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},f.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=l(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},f.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=l(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},f.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},f.prototype.promise=function(){return this._promise},f.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},f.prototype._continue=function(t){var n=this._promise;if(t===c)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var r=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var o=i(r,this._promise);if(o instanceof e||null!==(o=function(t,n,r){for(var o=0;o<n.length;++o){r._pushContext();var s=l(n[o])(t);if(r._popContext(),s===c){r._pushContext();var a=e.reject(c.e);return r._popContext(),a}var u=i(s,r);if(u instanceof e)return u}return null}(o,this._yieldHandlers,this._promise))){var s=(o=o._target())._bitField;0==(50397184&s)?(this._yieldedPromise=o,o._proxy(this,null)):0!=(33554432&s)?e._async.invoke(this._promiseFulfilled,this,o._value()):0!=(16777216&s)?e._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()}else this._promiseRejected(new a("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},e.coroutine=function(t,e){if("function"!=typeof t)throw new a("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,r=f,i=(new Error).stack;return function(){var e=t.apply(this,arguments),o=new r(void 0,void 0,n,i),s=o.promise();return o._generator=e,o._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new a("expecting a function but got "+u.classString(t));h.push(t)},e.spawn=function(t){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new f(t,this),i=r.promise();return r._run(e.spawn),i}}},{"./errors":12,"./util":36}],17:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util");s.canEvaluate,s.tryCatch,s.errorObj,e.join=function(){var t,e=arguments.length-1;e>0&&"function"==typeof arguments[e]&&(t=arguments[e]);var r=[].slice.call(arguments);t&&r.pop();var i=new n(r).promise();return void 0!==t?i.spread(t):i}}},{"./util":36}],18:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=t("./util"),u=a.tryCatch,c=a.errorObj,l=e._async;function h(t,n,r,i){this.constructor$(t),this._promise._captureStackTrace();var s=e._getContext();if(this._callback=a.contextBind(s,n),this._preservedValues=i===o?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=[],l.invoke(this._asyncInit,this,void 0),a.isArray(t))for(var u=0;u<t.length;++u){var c=t[u];c instanceof e&&c.suppressUnhandledRejections()}}function f(t,n,i,o){if("function"!=typeof n)return r("expecting a function but got "+a.classString(n));var s=0;if(void 0!==i){if("object"!=typeof i||null===i)return e.reject(new TypeError("options argument must be an object but it is "+a.classString(i)));if("number"!=typeof i.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+a.classString(i.concurrency)));s=i.concurrency}return new h(t,n,s="number"==typeof s&&isFinite(s)&&s>=1?s:0,o).promise()}a.inherits(h,n),h.prototype._asyncInit=function(){this._init$(void 0,-2)},h.prototype._init=function(){},h.prototype._promiseFulfilled=function(t,n){var r=this._values,o=this.length(),a=this._preservedValues,l=this._limit;if(n<0){if(r[n=-1*n-1]=t,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return r[n]=t,this._queue.push(n),!1;null!==a&&(a[n]=t);var h=this._promise,f=this._callback,d=h._boundValue();h._pushContext();var p=u(f).call(d,t,n,o),y=h._popContext();if(s.checkForgottenReturns(p,y,null!==a?"Promise.filter":"Promise.map",h),p===c)return this._reject(p.e),!0;var m=i(p,this._promise);if(m instanceof e){var v=(m=m._target())._bitField;if(0==(50397184&v))return l>=1&&this._inFlight++,r[n]=m,m._proxy(this,-1*(n+1)),!1;if(0==(33554432&v))return 0!=(16777216&v)?(this._reject(m._reason()),!0):(this._cancel(),!0);p=m._value()}r[n]=p}return++this._totalResolved>=o&&(null!==a?this._filter(r,a):this._resolve(r),!0)},h.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(n[r],r)}},h.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),i=0,o=0;o<n;++o)t[o]&&(r[i++]=e[o]);r.length=i,this._resolve(r)},h.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return f(this,t,e,null)},e.map=function(t,e,n,r){return f(t,e,n,r)}}},{"./util":36}],19:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util"),a=s.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+s.classString(t));return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var i=a(t).apply(this,arguments),s=r._popContext();return o.checkForgottenReturns(i,s,"Promise.method",r),r._resolveFromSyncValue(i),r}},e.attempt=e.try=function(t){if("function"!=typeof t)return i("expecting a function but got "+s.classString(t));var r,u=new e(n);if(u._captureStackTrace(),u._pushContext(),arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var c=arguments[1],l=arguments[2];r=s.isArray(c)?a(t).apply(l,c):a(t).call(l,c)}else r=a(t)();var h=u._popContext();return o.checkForgottenReturns(r,h,"Promise.try",u),u._resolveFromSyncValue(r),u},e.prototype._resolveFromSyncValue=function(t){t===s.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,n){"use strict";var r=t("./util"),i=r.maybeWrapAsError,o=t("./errors").OperationalError,s=t("./es5"),a=/^(?:name|message|stack|cause)$/;function u(t){var e;if(function(t){return t instanceof Error&&s.getPrototypeOf(t)===Error.prototype}(t)){(e=new o(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var n=s.keys(t),i=0;i<n.length;++i){var u=n[i];a.test(u)||(e[u]=t[u])}return e}return r.markAsOriginatingFromRejection(t),t}e.exports=function(t,e){return function(n,r){if(null!==t){if(n){var o=u(i(n));t._attachExtraTrace(o),t._reject(o)}else if(e){var s=[].slice.call(arguments,1);t._fulfill(s)}else t._fulfill(r);t=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),r=e._async,i=n.tryCatch,o=n.errorObj;function s(t,e){if(!n.isArray(t))return a.call(this,t,e);var s=i(e).apply(this._boundValue(),[null].concat(t));s===o&&r.throwLater(s.e)}function a(t,e){var n=this._boundValue(),s=void 0===t?i(e).call(n,null):i(e).call(n,null,t);s===o&&r.throwLater(s.e)}function u(t,e){if(!t){var n=new Error(t+"");n.cause=t,t=n}var s=i(e).call(this._boundValue(),t);s===o&&r.throwLater(s.e)}e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var n=a;void 0!==e&&Object(e).spread&&(n=s),this._then(n,u,void 0,this,t)}return this}}},{"./util":36}],22:[function(e,n,r){"use strict";n.exports=function(){var r=function(){return new g("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},i=function(){return new D.PromiseInspection(this._target())},o=function(t){return D.reject(new g(t))};function s(){}var a={},u=e("./util");u.setReflectHandler(i);var c=function(){var e=t.domain;return void 0===e?null:e},l=function(){return{domain:c(),async:null}},h=u.isNode&&u.nodeSupportsAsyncResource?e("async_hooks").AsyncResource:null,f=function(){return{domain:c(),async:new h("Bluebird::Promise")}},d=u.isNode?l:function(){return null};u.notEnumerableProp(D,"_getContext",d);var p=e("./es5"),y=e("./async"),m=new y;p.defineProperty(D,"_async",{value:m});var v=e("./errors"),g=D.TypeError=v.TypeError;D.RangeError=v.RangeError;var _=D.CancellationError=v.CancellationError;D.TimeoutError=v.TimeoutError,D.OperationalError=v.OperationalError,D.RejectionError=v.OperationalError,D.AggregateError=v.AggregateError;var b=function(){},w={},k={},O=e("./thenables")(D,b),E=e("./promise_array")(D,b,O,o,s),S=e("./context")(D),x=S.create,C=e("./debuggability")(D,S,(function(){d=f,u.notEnumerableProp(D,"_getContext",f)}),(function(){d=l,u.notEnumerableProp(D,"_getContext",l)})),T=(C.CapturedTrace,e("./finally")(D,O,k)),j=e("./catch_filter")(k),F=e("./nodeback"),A=u.errorObj,N=u.tryCatch;function D(t){t!==b&&function(t,e){if(null==t||t.constructor!==D)throw new g("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new g("expecting a function but got "+u.classString(e))}(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function P(t){this.promise._resolveCallback(t)}function I(t){this.promise._rejectCallback(t,!1)}function R(t){var e=new D(b);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}return D.prototype.toString=function(){return"[object Promise]"},D.prototype.caught=D.prototype.catch=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),i=0;for(n=0;n<e-1;++n){var s=arguments[n];if(!u.isObject(s))return o("Catch statement predicate: expecting an object but got "+u.classString(s));r[i++]=s}if(r.length=i,"function"!=typeof(t=arguments[n]))throw new g("The last argument to .catch() must be a function, got "+u.toString(t));return this.then(void 0,j(r,t,this))}return this.then(void 0,t)},D.prototype.reflect=function(){return this._then(i,i,void 0,this,void 0)},D.prototype.then=function(t,e){if(C.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+u.classString(t);arguments.length>1&&(n+=", "+u.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},D.prototype.done=function(t,e){this._then(t,e,void 0,void 0,void 0)._setIsFinal()},D.prototype.spread=function(t){return"function"!=typeof t?o("expecting a function but got "+u.classString(t)):this.all()._then(t,void 0,void 0,w,void 0)},D.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},D.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new E(this).promise()},D.prototype.error=function(t){return this.caught(u.originatesFromRejection,t)},D.getNewLibraryCopy=n.exports,D.is=function(t){return t instanceof D},D.fromNode=D.fromCallback=function(t){var e=new D(b);e._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=N(t)(F(e,n));return r===A&&e._rejectCallback(r.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},D.all=function(t){return new E(t).promise()},D.cast=function(t){var e=O(t);return e instanceof D||((e=new D(b))._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},D.resolve=D.fulfilled=D.cast,D.reject=D.rejected=function(t){var e=new D(b);return e._captureStackTrace(),e._rejectCallback(t,!0),e},D.setScheduler=function(t){if("function"!=typeof t)throw new g("expecting a function but got "+u.classString(t));return m.setScheduler(t)},D.prototype._then=function(t,e,n,r,i){var o=void 0!==i,s=o?i:new D(b),a=this._target(),c=a._bitField;o||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(r=0!=(50397184&c)?this._boundValue():a===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,s));var l=d();if(0!=(50397184&c)){var h,f,p=a._settlePromiseCtx;0!=(33554432&c)?(f=a._rejectionHandler0,h=t):0!=(16777216&c)?(f=a._fulfillmentHandler0,h=e,a._unsetRejectionIsUnhandled()):(p=a._settlePromiseLateCancellationObserver,f=new _("late cancellation observer"),a._attachExtraTrace(f),h=e),m.invoke(p,a,{handler:u.contextBind(l,h),promise:s,receiver:r,value:f})}else a._addCallbacks(t,e,s,r,l);return s},D.prototype._length=function(){return 65535&this._bitField},D.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},D.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},D.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},D.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},D.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},D.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},D.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},D.prototype._isFinal=function(){return(4194304&this._bitField)>0},D.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},D.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},D.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},D.prototype._setAsyncGuaranteed=function(){if(!m.hasCustomScheduler()){var t=this._bitField;this._bitField=t|(536870912&t)>>2^134217728}},D.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&(536870912|this._bitField)},D.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];if(e!==a)return void 0===e&&this._isBound()?this._boundValue():e},D.prototype._promiseAt=function(t){return this[4*t-4+2]},D.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},D.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},D.prototype._boundValue=function(){},D.prototype._migrateCallback0=function(t){t._bitField;var e=t._fulfillmentHandler0,n=t._rejectionHandler0,r=t._promise0,i=t._receiverAt(0);void 0===i&&(i=a),this._addCallbacks(e,n,r,i,null)},D.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),i=t._promiseAt(e),o=t._receiverAt(e);void 0===o&&(o=a),this._addCallbacks(n,r,i,o,null)},D.prototype._addCallbacks=function(t,e,n,r,i){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=u.contextBind(i,t)),"function"==typeof e&&(this._rejectionHandler0=u.contextBind(i,e));else{var s=4*o-4;this[s+2]=n,this[s+3]=r,"function"==typeof t&&(this[s+0]=u.contextBind(i,t)),"function"==typeof e&&(this[s+1]=u.contextBind(i,e))}return this._setLength(o+1),o},D.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},D.prototype._resolveCallback=function(t,e){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(r(),!1);var n=O(t,this);if(!(n instanceof D))return this._fulfill(t);e&&this._propagateFrom(n,2);var i=n._target();if(i!==this){var o=i._bitField;if(0==(50397184&o)){var s=this._length();s>0&&i._migrateCallback0(this);for(var a=1;a<s;++a)i._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(n)}else if(0!=(33554432&o))this._fulfill(i._value());else if(0!=(16777216&o))this._reject(i._reason());else{var u=new _("late cancellation observer");i._attachExtraTrace(u),this._reject(u)}}else this._reject(r())}},D.prototype._rejectCallback=function(t,e,n){var r=u.ensureErrorObject(t),i=r===t;if(!i&&!n&&C.warnings()){var o="a promise was rejected with a non-error: "+u.classString(t);this._warn(o,!0)}this._attachExtraTrace(r,!!e&&i),this._reject(t)},D.prototype._resolveFromExecutor=function(t){if(t!==b){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(t,(function(t){e._resolveCallback(t)}),(function(t){e._rejectCallback(t,n)}));n=!1,this._popContext(),void 0!==r&&e._rejectCallback(r,!0)}},D.prototype._settlePromiseFromHandler=function(t,e,n,r){var i=r._bitField;if(0==(65536&i)){var o;r._pushContext(),e===w?n&&"number"==typeof n.length?o=N(t).apply(this._boundValue(),n):(o=A).e=new g("cannot .spread() a non-array: "+u.classString(n)):o=N(t).call(e,n);var s=r._popContext();0==(65536&(i=r._bitField))&&(o===k?r._reject(n):o===A?r._rejectCallback(o.e,!1):(C.checkForgottenReturns(o,s,"",r,this),r._resolveCallback(o)))}},D.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},D.prototype._followee=function(){return this._rejectionHandler0},D.prototype._setFollowee=function(t){this._rejectionHandler0=t},D.prototype._settlePromise=function(t,e,n,r){var o=t instanceof D,a=this._bitField,u=0!=(134217728&a);0!=(65536&a)?(o&&t._invokeInternalOnCancel(),n instanceof T&&n.isFinallyHandler()?(n.cancelPromise=t,N(e).call(n,r)===A&&t._reject(A.e)):e===i?t._fulfill(i.call(n)):n instanceof s?n._promiseCancelled(t):o||t instanceof E?t._cancel():n.cancel()):"function"==typeof e?o?(u&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,n,r,t)):e.call(n,r,t):n instanceof s?n._isResolved()||(0!=(33554432&a)?n._promiseFulfilled(r,t):n._promiseRejected(r,t)):o&&(u&&t._setAsyncGuaranteed(),0!=(33554432&a)?t._fulfill(r):t._reject(r))},D.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,r=t.receiver,i=t.value;"function"==typeof e?n instanceof D?this._settlePromiseFromHandler(e,r,i,n):e.call(r,i,n):n instanceof D&&n._reject(i)},D.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},D.prototype._settlePromise0=function(t,e,n){var r=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,t,i,e)},D.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},D.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=r();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!=(134217728&e)?this._settlePromises():m.settlePromises(this),this._dereferenceTrace())}},D.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=t,this._isFinal())return m.fatalError(t,u.isNode);(65535&e)>0?m.settlePromises(this):this._ensurePossibleRejectionHandled()}},D.prototype._fulfillPromises=function(t,e){for(var n=1;n<t;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},D.prototype._rejectPromises=function(t,e){for(var n=1;n<t;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},D.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!=(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,t),this._fulfillPromises(e,r)}this._setLength(0)}this._clearCancellationData()},D.prototype._settledValue=function(){var t=this._bitField;return 0!=(33554432&t)?this._rejectionHandler0:0!=(16777216&t)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&p.defineProperty(D.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),D.defer=D.pending=function(){return C.deprecated("Promise.defer","new Promise"),{promise:new D(b),resolve:P,reject:I}},u.notEnumerableProp(D,"_makeSelfResolutionError",r),e("./method")(D,b,O,o,C),e("./bind")(D,b,O,C),e("./cancel")(D,E,o,C),e("./direct_resolve")(D),e("./synchronous_inspection")(D),e("./join")(D,E,O,b,m),D.Promise=D,D.version="3.7.2",e("./call_get.js")(D),e("./generators.js")(D,o,b,O,s,C),e("./map.js")(D,E,o,O,b,C),e("./nodeify.js")(D),e("./promisify.js")(D,b),e("./props.js")(D,E,O,o),e("./race.js")(D,b,O,o),e("./reduce.js")(D,E,o,O,b,C),e("./settle.js")(D,E,C),e("./some.js")(D,E,o),e("./timers.js")(D,b,C),e("./using.js")(D,o,O,x,b,C),e("./any.js")(D),e("./each.js")(D,b),e("./filter.js")(D,b),u.toFastProperties(D),u.toFastProperties(D.prototype),R({a:1}),R({b:2}),R({c:3}),R(1),R((function(){})),R(void 0),R(!1),R(new D(b)),C.setBounds(y.firstLineError,u.lastLineError),D}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36,async_hooks:void 0}],23:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util");function a(t){var r=this._promise=new e(n);t instanceof e&&(r._propagateFrom(t,3),t.suppressUnhandledRejections()),r._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return s.isArray,s.inherits(a,o),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function t(n,o){var a=r(this._values,this._promise);if(a instanceof e){var u=(a=a._target())._bitField;if(this._values=a,0==(50397184&u))return this._promise._setAsyncGuaranteed(),a._then(t,this._reject,void 0,this,o);if(0==(33554432&u))return 0!=(16777216&u)?this._reject(a._reason()):this._cancel();a=a._value()}if(null!==(a=s.asArray(a)))0!==a.length?this._iterate(a):-5===o?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}(o));else{var c=i("expecting an array or an iterable object but got "+s.classString(a)).reason();this._promise._rejectCallback(c,!1)}},a.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,o=!1,s=null,a=0;a<n;++a){var u=r(t[a],i);s=u instanceof e?(u=u._target())._bitField:null,o?null!==s&&u.suppressUnhandledRejections():null!==s?0==(50397184&s)?(u._proxy(this,a),this._values[a]=u):o=0!=(33554432&s)?this._promiseFulfilled(u._value(),a):0!=(16777216&s)?this._promiseRejected(u._reason(),a):this._promiseCancelled(a):o=this._promiseFulfilled(u,a)}o||i._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},a.prototype._promiseFulfilled=function(t,e){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(t){return t},a}},{"./util":36}],24:[function(t,e,n){"use strict";e.exports=function(e,n){var r={},i=t("./util"),o=t("./nodeback"),s=i.withAppended,a=i.maybeWrapAsError,u=i.canEvaluate,c=t("./errors").TypeError,l={__isPromisified__:!0},h=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),f=function(t){return i.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t};function d(t){return!h.test(t)}function p(t){try{return!0===t.__isPromisified__}catch(e){return!1}}function y(t,e,n){var r=i.getDataPropertyOrDefault(t,e+n,l);return!!r&&p(r)}var m=u?void 0:function(t,u,c,l,h,f){var d=function(){return this}(),p=t;function y(){var i=u;u===r&&(i=this);var c=new e(n);c._captureStackTrace();var l="string"==typeof p&&this!==d?this[p]:t,h=o(c,f);try{l.apply(i,s(arguments,h))}catch(y){c._rejectCallback(a(y),!0,!0)}return c._isFateSealed()||c._setAsyncGuaranteed(),c}return"string"==typeof p&&(t=l),i.notEnumerableProp(y,"__isPromisified__",!0),y};function v(t,e,n,o,s){for(var a=new RegExp(e.replace(/([$])/,"\\$")+"$"),u=function(t,e,n,r){for(var o=i.inheritedDataKeys(t),s=[],a=0;a<o.length;++a){var u=o[a],l=t[u],h=r===f||f(u);"function"!=typeof l||p(l)||y(t,u,e)||!r(u,l,t,h)||s.push(u,l)}return function(t,e,n){for(var r=0;r<t.length;r+=2){var i=t[r];if(n.test(i))for(var o=i.replace(n,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new c("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}(s,e,n),s}(t,e,a,n),l=0,h=u.length;l<h;l+=2){var d=u[l],v=u[l+1],g=d+e;if(o===m)t[g]=m(d,r,d,v,e,s);else{var _=o(v,(function(){return m(d,r,d,v,e,s)}));i.notEnumerableProp(_,"__isPromisified__",!0),t[g]=_}}return i.toFastProperties(t),t}e.promisify=function(t,e){if("function"!=typeof t)throw new c("expecting a function but got "+i.classString(t));if(p(t))return t;var n,o,s,a=(n=t,o=void 0===(e=Object(e)).context?r:e.context,s=!!e.multiArgs,m(n,o,void 0,n,null,s));return i.copyDescriptors(t,a,d),a},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new c("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(e=Object(e)).multiArgs,r=e.suffix;"string"!=typeof r&&(r="Async");var o=e.filter;"function"!=typeof o&&(o=f);var s=e.promisifier;if("function"!=typeof s&&(s=m),!i.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=i.inheritedDataKeys(t),u=0;u<a.length;++u){var l=t[a[u]];"constructor"!==a[u]&&i.isClass(l)&&(v(l.prototype,r,o,s,n),v(l,r,o,s,n))}return v(t,r,o,s,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o,s=t("./util"),a=s.isObject,u=t("./es5");"function"==typeof Map&&(o=Map);var c=function(){var t=0,e=0;function n(n,r){this[t]=n,this[t+e]=r,t++}return function(r){e=r.size,t=0;var i=new Array(2*r.size);return r.forEach(n,i),i}}();function l(t){var e,n=!1;if(void 0!==o&&t instanceof o)e=c(t),n=!0;else{var r=u.keys(t),i=r.length;e=new Array(2*i);for(var s=0;s<i;++s){var a=r[s];e[s]=t[a],e[s+i]=a}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function h(t){var n,o=r(t);return a(o)?(n=o instanceof e?o._then(e.props,void 0,void 0,void 0,void 0):new l(o).promise(),o instanceof e&&n._propagateFrom(o,2),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}s.inherits(l,n),l.prototype._init=function(){},l.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){var n;if(this._isMap)n=function(t){for(var e=new o,n=t.length/2|0,r=0;r<n;++r){var i=t[n+r],s=t[r];e.set(i,s)}return e}(this._values);else{n={};for(var r=this.length(),i=0,s=this.length();i<s;++i)n[this._values[i+r]]=this._values[i]}return this._resolve(n),!0}return!1},l.prototype.shouldCopyValues=function(){return!1},l.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return h(this)},e.props=function(t){return h(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,n){"use strict";function r(t){this._capacity=t,this._length=0,this._front=0}r.prototype._willBeOverCapacity=function(t){return this._capacity<t},r.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},r.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=n,this._length=r},r.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},r.prototype.length=function(){return this._length},r.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},r.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,function(t,e,n,r,i){for(var o=0;o<i;++o)n[o+r]=t[o+0],t[o+0]=void 0}(this,0,this,e,this._front+this._length&e-1)},e.exports=r},{}],27:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util");function s(t,a){var u,c=r(t);if(c instanceof e)return(u=c).then((function(t){return s(t,u)}));if(null===(t=o.asArray(t)))return i("expecting an array or an iterable object but got "+o.classString(t));var l=new e(n);void 0!==a&&l._propagateFrom(a,3);for(var h=l._fulfill,f=l._reject,d=0,p=t.length;d<p;++d){var y=t[d];(void 0!==y||d in t)&&e.cast(y)._then(h,f,void 0,l,null)}return l}e.race=function(t){return s(t,void 0)},e.prototype.race=function(){return s(this,void 0)}}},{"./util":36}],28:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=t("./util"),u=a.tryCatch;function c(t,n,r,i){this.constructor$(t);var s=e._getContext();this._fn=a.contextBind(s,n),void 0!==r&&(r=e.resolve(r))._attachCancellationCallback(this),this._initialValue=r,this._currentCancellable=null,this._eachValues=i===o?Array(this._length):0===i?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function l(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function h(t,e,n,i){return"function"!=typeof e?r("expecting a function but got "+a.classString(e)):new c(t,e,n,i).promise()}function f(t){this.accum=t,this.array._gotAccum(t);var n=i(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(d,void 0,void 0,this,void 0)):d.call(this,n)}function d(t){var n,r=this.array,i=r._promise,o=u(r._fn);i._pushContext(),(n=void 0!==r._eachValues?o.call(i._boundValue(),t,this.index,this.length):o.call(i._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(r._currentCancellable=n);var a=i._popContext();return s.checkForgottenReturns(n,a,void 0!==r._eachValues?"Promise.each":"Promise.reduce",i),n}a.inherits(c,n),c.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==o&&this._eachValues.push(t)},c.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},c.prototype._init=function(){},c.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},c.prototype.shouldCopyValues=function(){return!1},c.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},c.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},c.prototype._iterate=function(t){var n,r;this._values=t;var i=t.length;void 0!==this._initialValue?(n=this._initialValue,r=0):(n=e.resolve(t[0]),r=1),this._currentCancellable=n;for(var o=r;o<i;++o){var s=t[o];s instanceof e&&s.suppressUnhandledRejections()}if(!n.isRejected())for(;r<i;++r){var a={accum:null,value:t[r],index:r,length:i,array:this};n=n._then(f,void 0,void 0,a,void 0),0==(127&r)&&n._setNoAsyncGuarantee()}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(l,l,void 0,n,this)},e.prototype.reduce=function(t,e){return h(this,t,e,null)},e.reduce=function(t,e,n,r){return h(t,e,n,r)}}},{"./util":36}],29:[function(r,i,o){"use strict";var s,a,u,c,l,h=r("./util"),f=h.getNativePromise();if(h.isNode&&"undefined"==typeof MutationObserver){var d=e.setImmediate,p=t.nextTick;s=h.isRecentNode?function(t){d.call(e,t)}:function(e){p.call(t,e)}}else if("function"==typeof f&&"function"==typeof f.resolve){var y=f.resolve();s=function(t){y.then(t)}}else s="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)||!("classList"in document.documentElement)?void 0!==n?function(t){n(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:(a=document.createElement("div"),u={attributes:!0},c=!1,l=document.createElement("div"),new MutationObserver((function(){a.classList.toggle("foo"),c=!1})).observe(l,u),function(t){var e=new MutationObserver((function(){e.disconnect(),t()}));e.observe(a,u),c||(c=!0,l.classList.toggle("foo"))});i.exports=s},{"./util":36}],30:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=e.PromiseInspection;function o(t){this.constructor$(t)}t("./util").inherits(o,n),o.prototype._promiseResolved=function(t,e){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},o.prototype._promiseFulfilled=function(t,e){var n=new i;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},o.prototype._promiseRejected=function(t,e){var n=new i;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return r.deprecated(".settle()",".reflect()"),new o(t).promise()},e.allSettled=function(t){return new o(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),o=t("./errors").RangeError,s=t("./errors").AggregateError,a=i.isArray,u={};function c(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function l(t,e){if((0|e)!==e||e<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new c(t),i=n.promise();return n.setHowMany(e),n.init(),i}i.inherits(c,n),c.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=a(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},c.prototype.init=function(){this._initialized=!0,this._init()},c.prototype.setUnwrap=function(){this._unwrap=!0},c.prototype.howMany=function(){return this._howMany},c.prototype.setHowMany=function(t){this._howMany=t},c.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},c.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},c.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(u),this._checkOutcome())},c.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new s,e=this.length();e<this._values.length;++e)this._values[e]!==u&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},c.prototype._fulfilled=function(){return this._totalResolved},c.prototype._rejected=function(){return this._values.length-this.length()},c.prototype._addRejected=function(t){this._values.push(t)},c.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},c.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},c.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new o(e)},c.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return l(t,e)},e.prototype.some=function(t){return l(this,t)},e._SomePromiseArray=c}},{"./errors":12,"./util":36}],32:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},s=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},a=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return s.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return i.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,n){"use strict";e.exports=function(e,n){var r=t("./util"),i=r.errorObj,o=r.isObject,s={}.hasOwnProperty;return function(t,a){if(o(t)){if(t instanceof e)return t;var u=function(t){try{return function(t){return t.then}(t)}catch(e){return i.e=e,i}}(t);if(u===i){a&&a._pushContext();var c=e.reject(u.e);return a&&a._popContext(),c}if("function"==typeof u)return function(t){try{return s.call(t,"_promise0")}catch(e){return!1}}(t)?(c=new e(n),t._then(c._fulfill,c._reject,void 0,c,null),c):function(t,o,s){var a=new e(n),u=a;s&&s._pushContext(),a._captureStackTrace(),s&&s._popContext();var c=!0,l=r.tryCatch(o).call(t,(function(t){a&&(a._resolveCallback(t),a=null)}),(function(t){a&&(a._rejectCallback(t,c,!0),a=null)}));return c=!1,a&&l===i&&(a._rejectCallback(l.e,!0,!0),a=null),u}(t,u,a)}return t}}},{"./util":36}],34:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),o=e.TimeoutError;function s(t){this.handle=t}s.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(t){return u(+this).thenReturn(t)},u=e.delay=function(t,i){var o,u;return void 0!==i?(o=e.resolve(i)._then(a,null,null,t,void 0),r.cancellation()&&i instanceof e&&o._setOnCancel(i)):(o=new e(n),u=setTimeout((function(){o._fulfill()}),+t),r.cancellation()&&o._setOnCancel(new s(u)),o._captureStackTrace()),o._setAsyncGuaranteed(),o};function c(t){return clearTimeout(this.handle),t}function l(t){throw clearTimeout(this.handle),t}e.prototype.delay=function(t){return u(t,this)},e.prototype.timeout=function(t,e){var n,a;t=+t;var u=new s(setTimeout((function(){n.isPending()&&function(t,e,n){var r;r="string"!=typeof e?e instanceof Error?e:new o("operation timed out"):new o(e),i.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._reject(r),null!=n&&n.cancel()}(n,e,a)}),t));return r.cancellation()?(a=this.then(),(n=a._then(c,l,void 0,u,void 0))._setOnCancel(u)):n=this._then(c,l,void 0,u,void 0),n}}},{"./util":36}],35:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=t("./util"),u=t("./errors").TypeError,c=t("./util").inherits,l=a.errorObj,h=a.tryCatch,f={};function d(t){setTimeout((function(){throw t}),0)}function p(t,n){var i=0,s=t.length,a=new e(o);return function o(){if(i>=s)return a._fulfill();var u=function(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}(t[i++]);if(u instanceof e&&u._isDisposable()){try{u=r(u._getDisposer().tryDispose(n),t.promise)}catch(c){return d(c)}if(u instanceof e)return u._then(o,d,null,null,null)}o()}(),a}function y(t,e,n){this._data=t,this._promise=e,this._context=n}function m(t,e,n){this.constructor$(t,e,n)}function v(t){return y.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function g(t){this.length=t,this.promise=null,this[t-1]=null}y.prototype.data=function(){return this._data},y.prototype.promise=function(){return this._promise},y.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():f},y.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=e!==f?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},y.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},c(m,y),m.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},g.prototype._resultCancelled=function(){for(var t=this.length,n=0;n<t;++n){var r=this[n];r instanceof e&&r.cancel()}},e.using=function(){var t=arguments.length;if(t<2)return n("you must pass at least 2 arguments to Promise.using");var i,o=arguments[t-1];if("function"!=typeof o)return n("expecting a function but got "+a.classString(o));var u=!0;2===t&&Array.isArray(arguments[0])?(t=(i=arguments[0]).length,u=!1):(i=arguments,t--);for(var c=new g(t),f=0;f<t;++f){var d=i[f];if(y.isDisposer(d)){var m=d;(d=d.promise())._setDisposable(m)}else{var _=r(d);_ instanceof e&&(d=_._then(v,null,null,{resources:c,index:f},void 0))}c[f]=d}var b=new Array(c.length);for(f=0;f<b.length;++f)b[f]=e.resolve(c[f]).reflect();var w=e.all(b).then((function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return l.e=n.error(),l;if(!n.isFulfilled())return void w.cancel();t[e]=n.value()}k._pushContext(),o=h(o);var r=u?o.apply(void 0,t):o(t),i=k._popContext();return s.checkForgottenReturns(r,i,"Promise.using",k),r})),k=w.lastly((function(){var t=new e.PromiseInspection(w);return p(c,t)}));return c.promise=k,k._setOnCancel(c),k},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new m(t,this,i());throw new u}}},{"./errors":12,"./util":36}],36:[function(n,r,i){"use strict";var o,s=n("./es5"),a="undefined"==typeof navigator,u={e:{}},c="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:void 0!==this?this:null;function l(){try{var t=o;return o=null,t.apply(this,arguments)}catch(e){return u.e=e,u}}function h(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function f(t,e,n){if(h(t))return t;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return s.defineProperty(t,e,r),t}var d=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(s.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var r=[],i=Object.create(null);null!=t&&!e(t);){var o;try{o=n(t)}catch(l){return r}for(var a=0;a<o.length;++a){var u=o[a];if(!i[u]){i[u]=!0;var c=Object.getOwnPropertyDescriptor(t,u);null!=c&&null==c.get&&null==c.set&&r.push(u)}}t=s.getPrototypeOf(t)}return r}}var r={}.hasOwnProperty;return function(n){if(e(n))return[];var i=[];t:for(var o in n)if(r.call(n,o))i.push(o);else{for(var s=0;s<t.length;++s)if(r.call(t[s],o))continue t;i.push(o)}return i}}(),p=/this\s*\.\s*\S+\s*=/;var y=/^[a-z$_][a-z$_0-9]*$/i;function m(t){try{return t+""}catch(e){return"[no string representation]"}}function v(t){return t instanceof Error||null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function g(t){return v(t)&&s.propertyIsWritable(t,"stack")}var _="stack"in new Error?function(t){return g(t)?t:new Error(m(t))}:function(t){if(g(t))return t;try{throw new Error(m(t))}catch(e){return e}};function b(t){return{}.toString.call(t)}var w=function(t){return s.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var k="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],r=t[Symbol.iterator]();!(e=r.next()).done;)n.push(e.value);return n};w=function(t){return s.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?k(t):null}}var O,E=void 0!==t&&"[object process]"===b(t).toLowerCase(),S=void 0!==t&&void 0!==t.env;var x,C={setReflectHandler:function(t){O=t},isClass:function(t){try{if("function"==typeof t){var e=s.names(t.prototype),n=s.isES5&&e.length>1,r=e.length>0&&!(1===e.length&&"constructor"===e[0]),i=p.test(t+"")&&s.names(t).length>0;if(n||r||i)return!0}return!1}catch(o){return!1}},isIdentifier:function(t){return y.test(t)},inheritedDataKeys:d,getDataPropertyOrDefault:function(t,e,n){if(!s.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var r=Object.getOwnPropertyDescriptor(t,e);return null!=r?null==r.get&&null==r.set?r.value:n:void 0},thrower:function(t){throw t},isArray:s.isArray,asArray:w,notEnumerableProp:f,isPrimitive:h,isObject:function(t){return"function"==typeof t||"object"==typeof t&&null!==t},isError:v,canEvaluate:a,errorObj:u,tryCatch:function(t){return o=t,l},inherits:function(t,e){var n={}.hasOwnProperty;function r(){for(var r in this.constructor=t,this.constructor$=e,e.prototype)n.call(e.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=e.prototype[r])}return r.prototype=e.prototype,t.prototype=new r,t.prototype},withAppended:function(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;n<r;++n)i[n]=t[n];return i[n]=e,i},maybeWrapAsError:function(t){return h(t)?new Error(m(t)):t},toFastProperties:function(t){function e(){}e.prototype=t;var n=new e;function r(){return typeof n.foo}return r(),r(),t},filledRange:function(t,e,n){for(var r=new Array(t),i=0;i<t;++i)r[i]=e+i+n;return r},toString:m,canAttachTrace:g,ensureErrorObject:_,originatesFromRejection:function(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)},markAsOriginatingFromRejection:function(t){try{f(t,"isOperational",!0)}catch(e){}},classString:b,copyDescriptors:function(t,e,n){for(var r=s.names(t),i=0;i<r.length;++i){var o=r[i];if(n(o))try{s.defineProperty(e,o,s.getDescriptor(t,o))}catch(a){}}},isNode:E,hasEnvVariables:S,env:function(e){return S?t.env[e]:void 0},global:c,getNativePromise:function(){if("function"==typeof Promise)try{if("[object Promise]"===b(new Promise((function(){}))))return Promise}catch(t){}},contextBind:function(t,e){if(null===t||"function"!=typeof e||e===O)return e;null!==t.domain&&(e=t.domain.bind(e));var n=t.async;if(null!==n){var r=e;e=function(){var t=new Array(2).concat([].slice.call(arguments));return t[0]=r,t[1]=this,n.runInAsyncScope.apply(n,t)}}return e}};C.isRecentNode=C.isNode&&(t.versions&&t.versions.node?x=t.versions.node.split(".").map(Number):t.version&&(x=t.version.split(".").map(Number)),0===x[0]&&x[1]>10||x[0]>0),C.nodeSupportsAsyncResource=C.isNode&&function(){var t=!1;try{t="function"==typeof n("async_hooks").AsyncResource.prototype.runInAsyncScope}catch(e){t=!1}return t}(),C.isNode&&C.toFastProperties(t);try{throw new Error}catch(T){C.lastLineError=T}r.exports=C},{"./es5":13,async_hooks:void 0}]},{},[4])(4)})),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("timers").setImmediate),wi=wi.exports;const ki=class{constructor(){this.cache=new class{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[ri]=t.max||1/0;const e=t.length||di;if(this[oi]="function"!=typeof e?di:e,this[si]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[ai]=t.maxAge||0,this[ui]=t.dispose,this[ci]=t.noDisposeOnSet||!1,this[fi]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[ri]=t||1/0,mi(this)}get max(){return this[ri]}set allowStale(t){this[si]=!!t}get allowStale(){return this[si]}set maxAge(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[ai]=t,mi(this)}get maxAge(){return this[ai]}set lengthCalculator(t){"function"!=typeof t&&(t=di),t!==this[oi]&&(this[oi]=t,this[ii]=0,this[li].forEach(t=>{t.length=this[oi](t.value,t.key),this[ii]+=t.length})),mi(this)}get lengthCalculator(){return this[oi]}get length(){return this[ii]}get itemCount(){return this[li].length}rforEach(t,e){e=e||this;for(let n=this[li].tail;null!==n;){const r=n.prev;_i(this,t,n,e),n=r}}forEach(t,e){e=e||this;for(let n=this[li].head;null!==n;){const r=n.next;_i(this,t,n,e),n=r}}keys(){return this[li].toArray().map(t=>t.key)}values(){return this[li].toArray().map(t=>t.value)}reset(){this[ui]&&this[li]&&this[li].length&&this[li].forEach(t=>this[ui](t.key,t.value)),this[hi]=new Map,this[li]=new Xr,this[ii]=0}dump(){return this[li].map(t=>!yi(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[li]}set(t,e,n){if((n=n||this[ai])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,i=this[oi](e,t);if(this[hi].has(t)){if(i>this[ri])return vi(this,this[hi].get(t)),!1;const o=this[hi].get(t).value;return this[ui]&&(this[ci]||this[ui](t,o.value)),o.now=r,o.maxAge=n,o.value=e,this[ii]+=i-o.length,o.length=i,this.get(t),mi(this),!0}const o=new gi(t,e,i,r,n);return o.length>this[ri]?(this[ui]&&this[ui](t,e),!1):(this[ii]+=o.length,this[li].unshift(o),this[hi].set(t,this[li].head),mi(this),!0)}has(t){if(!this[hi].has(t))return!1;const e=this[hi].get(t).value;return!yi(this,e)}get(t){return pi(this,t,!0)}peek(t){return pi(this,t,!1)}pop(){const t=this[li].tail;return t?(vi(this,t),t.value):null}del(t){vi(this,this[hi].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const t=i-e;t>0&&this.set(r.k,r.v,t)}}}prune(){this[hi].forEach((t,e)=>pi(this,e,!1))}}({max:1e5,length:function(t,e){return 16},maxAge:3e5})}seen(t){if(this.cache.peek(t))return!0;this.cache.set(t,!0)}},Oi=wi;Oi.config({cancellation:!0});const Ei=new l;var Si=class{constructor({db:t,ns:e,stream:n,from:r,after:i,to:o,until:s,types:a,filters:u,limit:c}){this._db=t,this._ns=e,this.stream=n,this.from=r,this.after=i,this.to=o,this.until=s,this.types=a,this.filters=u||[],this.limit=c,this.shouldRead=!0}get api(){return this.account.api}get account(){return this.db.account}get db(){return this._db||this.ns.db}get ns(){return this._ns||(this.stream?this.stream.ns:void 0)}filter(t){return this.filters.push(t),this}group(t){return this.groupby=t,this.until||(this.until="caught-up"),this}rollup(t){return this.rollupto=t,this}async write(t){return 1===arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof String)&&(t={meta:{type:arguments[0]},data:{}}),2===arguments.length&&(t={meta:{type:arguments[0]},data:{...arguments[1]}}),await this.api.writeStream({db:this.db.name,ns:this.ns.name,stream:this.stream.id,id:t.id,data:t.data,meta:t.meta})}async each(t){let e=new ki,n={db:this.db.name,ns:this.ns?this.ns.name:void 0,stream:this.stream?this.stream.id:void 0,from:this.from,after:this.after,to:this.to,until:this.until,types:this.types,filters:this.filters,groupby:this.groupby,rollupto:this.rollupto,limit:this.groupby?void 0:this.limit||50,each:async(n,r)=>await async function(t,e,n,r){return new Oi(async(i,o)=>{Ei.run(async(o,s)=>{e.meta&&e.meta.id&&t.seen(e.meta.id)||await n(e,r),i(),s.success()})})}(e,n,t,r)};await async function(t,e){let n=t.readDatabase.bind(t),r=e.after;for(;;){let t=await n({...e,after:r});if(!t)break;r=t,e.from=void 0}return r}(this.api,n)}},xi=class{constructor(t,e,n){this.id=t||xr(),this.ns=e,n&&(this.created=n.created,this.modified=n.modified,this.size=n.size,this.annotation=n.annotation)}get api(){return this.account.api}get account(){return this.db.account}get db(){return this.ns.db}events(t){return new Si({...t,stream:this})}event(t){return new bi(this,t)}async annotate(t){return this.api.annotateStream({db:this.db.name,ns:this.ns.name,stream:this.id,annotation:t})}annotation(){return new class{constructor(t){this.stream=t}get api(){return this.account.api}get account(){return this.db.account}get db(){return this.ns.db}get ns(){return this.stream.ns}async destroy(){return this.api.destroyAnnotation({db:this.db.name,ns:this.ns.name,stream:this.stream.id})}async read(){return this.api.readAnnotation({db:this.db.name,ns:this.ns.name,stream:this.stream.id})}}(this)}async destroy(){return this.api.destroyStream({db:this.db.name,ns:this.ns.name,stream:this.id})}},Ci=class{constructor({db:t,ns:e}){this._db=t,this.ns=e}get api(){return this.account.api}get account(){return this.db.account}get db(){var t;return this._db||(null===(t=this.ns)||void 0===t?void 0:t.db)}stream(t,e){return(e.ns?this.db.ns(e.ns):this.ns).stream(t,e)}async each(t){var e;return this.api.listStreams({db:this.db.name,ns:null===(e=this.ns)||void 0===e?void 0:e.name,each:async e=>await t(this.stream(e.id,e))}).catch(t=>{throw t})}async all(){let t=[];return await this.each(e=>t.push(e)),t.sort((t,e)=>t.id.localeCompare(e.id)),t}},Ti=class{constructor(t,e){this.name=t,this.db=e}get api(){return this.account.api}get account(){return this.db.account}streams(){return new Ci({ns:this})}stream(t,e){return new xi(t,this,e)}events(t){return"string"==typeof t&&(t={types:[t]}),new Si({...t,ns:this})}async create(){return await this.api.createNamespace({db:this.db.name,ns:this.name}),this}async destroy(){await this.api.destroyNamespace({db:this.db.name,ns:this.name})}async truncate(){await this.api.truncateNamespace({db:this.db.name,ns:this.name})}async rename(t){return await this.api.renameNamespace({db:this.db.name,ns:this.name,to:t}),this.name=t,this}async export(){return await this.streams().each(t=>this.stream(t.id).export()),this}};const ji=Ci;var Fi,Ai,Ni=class{constructor(t){this.api=t}async details(){return this.api.getAccount()}dbs(){return new class{constructor(t){this.account=t}get api(){return this.account.api}async each(t){return this.api.listDatabases({each:t}).catch(t=>{throw t})}async all(){let t=[];return await this.each(e=>t.push(e)),t.sort((t,e)=>t.localeCompare(e)),t}}(this)}db(t){return new class{constructor(t,e){this.name=t,this.account=e}get api(){return this.account.api}namespaces(){return new class{constructor(t){this.db=t}get api(){return this.account.api}get account(){return this.db.account}namespace(t){return this.ns(t)}ns(t){return new Ti(t,this.db)}async each(t){return this.api.listNamespaces({db:this.db.name,each:async e=>await t(this.ns(e))}).catch(t=>{throw t})}async all(){let t=[];return await this.each(e=>t.push(e)),t.sort((t,e)=>t.name.localeCompare(e.name)),t}}(this)}namespace(t){return this.ns(t)}ns(t){return new Ti(t,this)}streams(t){return t.ns&&(t.ns=this.ns(t.ns)),new ji({...t,db:this})}events(t){return new Si({...t,db:this})}stream(t){return this.ns("").stream(t)}async create(){return await this.api.createDatabase({db:this.name}),this}async destroy(){await this.api.destroyDatabase({db:this.name})}async rename(t){return await this.api.renameDatabase({db:this.name,to:t}),this.name=t,this}async grant({role:t,email:e}){return await this.api.grantAccount({db:this.name,role:t,email:e}),this}async revoke({email:t}){return await this.api.revokeAccount({db:this.name,email:t}),this}}(t,this)}databases(){return this.dbs()}database(t){return this.db(t)}},Di=function(t,e){let n={};return Object.keys(t).filter(t=>!t.startsWith(e)).forEach(e=>{n[e]=t[e]}),n},Pi={exports:{}};Fi=this,Ai=function(t){"use strict";function e(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function n(t){var n;return 1===t.length&&(n=t,t=function(t,r){return e(n(t),r)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}var r=n(e);r.right,r.left;function i(t){return t}function o(t,e,n,r){return function t(i,o){if(o>=r.length)return n(i);const s=new Map,a=r[o++];let u=-1;for(const e of i){const t=a(e,++u,i),n=s.get(t);n?n.push(e):s.set(t,[e])}for(const[e,n]of s)s.set(e,t(n,o));return e(s)}(t,0)}Array.prototype.slice;Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);t.group=function(t,...e){return o(t,i,i,e)},t.rollup=function(t,e,...n){return o(t,i,e,n)},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof Pi.exports?Ai(Pi.exports):"function"==typeof define&&define.amd?define(["exports"],Ai):Ai((Fi=Fi||self).d3=Fi.d3||{}),Pi=Pi.exports;var Ii={};Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.typeChecker=function(t){var e="[object "+t+"]";return function(t){return Ri(t)===e}};var Ri=function(t){return Object.prototype.toString.call(t)};Ii.comparable=function(t){return t instanceof Date?t.getTime():Ii.isArray(t)?t.map(Ii.comparable):t&&"function"==typeof t.toJSON?t.toJSON():t},Ii.isArray=Ii.typeChecker("Array"),Ii.isObject=Ii.typeChecker("Object"),Ii.isFunction=Ii.typeChecker("Function"),Ii.isVanillaObject=function(t){return t&&(t.constructor===Object||t.constructor===Array||"function Object() { [native code] }"===t.constructor.toString()||"function Array() { [native code] }"===t.constructor.toString())&&!t.toJSON},Ii.equals=function(t,e){if(null==t&&t==e)return!0;if(t===e)return!0;if(Object.prototype.toString.call(t)!==Object.prototype.toString.call(e))return!1;if(Ii.isArray(t)){if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(!Ii.equals(t[n],e[n]))return!1;return!0}if(Ii.isObject(t)){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var i in t)if(!Ii.equals(t[i],e[i]))return!1;return!0}return!1};var Mi,Li={},Vi=this&&this.__extends||(Mi=function(t,e){return(Mi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Mi(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),$i=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r};Object.defineProperty(Li,"__esModule",{value:!0});var qi=function(t,e,n,r,i,o){var s=e[r];if(Ii.isArray(t)&&isNaN(Number(s)))for(var a=0,u=t.length;a<u;a++)if(!qi(t[a],e,n,r,a,t))return!1;return r===e.length||null==t?n(t,i,o):qi(t[s],e,n,r+1,s,t)},Ui=function(){function t(t,e,n){this.params=t,this.owneryQuery=e,this.options=n,this.init()}return t.prototype.init=function(){},t.prototype.reset=function(){this.done=!1,this.success=!1},t}();Li.BaseOperation=Ui;var zi=function(t){function e(e,n,r,i){var o=t.call(this,e,n,r)||this;return o._children=i,o}return Vi(e,t),e.prototype.reset=function(){this.success=!1,this.done=!1;for(var t=0,e=this._children.length;t<e;t++)this._children[t].reset()},e.prototype.childrenNext=function(t,e,n){for(var r=!0,i=!0,o=0,s=this._children.length;o<s;o++){var a=this._children[o];if(a.next(t,e,n),a.success||(i=!1),a.done){if(!a.success)break}else r=!1}this.done=r,this.success=i},e}(Ui);Li.GroupOperation=zi;var Hi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Vi(e,t),e.prototype.next=function(t,e,n){this.childrenNext(t,e,n)},e}(zi),Bi=function(t){function e(e,n,r,i,o){var s=t.call(this,n,r,i,o)||this;return s.keyPath=e,s._nextNestedValue=function(t,e,n){return s.childrenNext(t,e,n),!s.done},s}return Vi(e,t),e.prototype.next=function(t,e,n){qi(t,this.keyPath,this._nextNestedValue,0,e,n)},e}(zi);Li.createTester=function(t,e){if(t instanceof Function)return t;if(t instanceof RegExp)return function(e){return"string"==typeof e&&t.test(e)};var n=Ii.comparable(t);return function(t){return e(n,Ii.comparable(t))}};var Zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Vi(e,t),e.prototype.init=function(){this._test=Li.createTester(this.params,this.options.compare)},e.prototype.next=function(t,e,n){this._test(t,e,n)&&(this.done=!0,this.success=!0)},e}(Ui);Li.EqualsOperation=Zi,Li.createEqualsOperation=function(t,e,n){return new Zi(t,e,n)};var Gi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Vi(e,t),e.prototype.next=function(){this.done=!0,this.success=!1},e}(Ui);Li.numericalOperationCreator=function(t){return function(e,n,r){return null==e?new Gi(e,n,r):t(e,n,r)}},Li.numericalOperation=function(t){return Li.numericalOperationCreator((function(e,n,r){var i=typeof Ii.comparable(e),o=t(e);return new Zi((function(t){return typeof Ii.comparable(t)===i&&o(t)}),n,r)}))};var Wi=function(t,e,n,r){var i=r.operations[t];if(!i)throw new Error("Unsupported operation: "+t);return i(e,n,r)},Ji=function(t,e,n,r){if(function(t){for(var e in t)if("$"===e.charAt(0))return!0;return!1}(e)){var i=Qi(e,r),o=i[0];if(i[1].length)throw new Error("Property queries must contain only operations, or exact objects.");return new Bi(t,e,n,r,o)}return new Bi(t,e,n,r,[new Zi(e,n,r)])};Li.createQueryOperation=function(t,e,n){var r=Qi(t,n),i=r[0],o=r[1],s=$i([new Bi([],t,e,n,i)],o);return 1===s.length?s[0]:new Hi(t,e,n,s)};var Qi=function(t,e){var n=[],r=[];if(!Ii.isVanillaObject(t))return n.push(new Zi(t,t,e)),[n,r];for(var i in t)if("$"===i.charAt(0)){var o=Wi(i,t[i],t,e);null!=o&&n.push(o)}else r.push(Ji(i.split("."),t[i],t,e));return[n,r]};Li.createQueryTester=function(t,e){var n=void 0===e?{}:e,r=n.compare,i=n.operations,o=Li.createQueryOperation(t,null,{compare:r||Ii.equals,operations:Object.assign({},i||{})});return function(t,e,n){return o.reset(),o.next(t,e,n),o.success}};var Yi={};(function(t){"use strict";var e,n=this&&this.__extends||(e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,n)},function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(Yi,"__esModule",{value:!0});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){this._test=Li.createTester(this.params,this.options.compare)},e.prototype.reset=function(){t.prototype.reset.call(this),this.success=!0},e.prototype.next=function(t){this._test(t)&&(this.done=!0,this.success=!1)},e}(Li.BaseOperation),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){this._queryOperation=Li.createQueryOperation(this.params,this.owneryQuery,this.options)},e.prototype.reset=function(){this._queryOperation.reset()},e.prototype.next=function(t,e,n){this._queryOperation.next(t,e,n),this.done=this._queryOperation.done,this.success=this._queryOperation.success},e}(Li.BaseOperation),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.next=function(e,n,r){t.prototype.next.call(this,e,n,r),this.success=!this.success},e}(i),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){var t=this;this._ops=this.params.map((function(e){return Li.createQueryOperation(e,null,t.options)}))},e.prototype.reset=function(){this.done=!1,this.success=!1;for(var t=0,e=this._ops.length;t<e;t++)this._ops[t].reset()},e.prototype.next=function(t,e,n){for(var r=!1,i=!1,o=0,s=this._ops.length;o<s;o++){var a=this._ops[o];if(a.next(t,e,n),a.success){r=!0,i=a.success;break}}this.success=i,this.done=r},e}(Li.BaseOperation),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.next=function(e,n,r){t.prototype.next.call(this,e,n,r),this.success=!this.success},e}(s),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.next=function(t,e,n){n.hasOwnProperty(e)===this.params&&(this.done=!0,this.success=!0)},e}(Li.BaseOperation),c=function(t){function e(e,n,r){return t.call(this,e,n,r,e.map((function(t){return Li.createQueryOperation(t,n,r)})))||this}return n(e,t),e.prototype.next=function(t,e,n){this.childrenNext(t,e,n)},e}(Li.GroupOperation);Yi.$eq=function(t,e,n){return new Li.EqualsOperation(t,e,n)},Yi.$ne=function(t,e,n){return new r(t,e,n)},Yi.$or=function(t,e,n){return new s(t,e,n)},Yi.$nor=function(t,e,n){return new a(t,e,n)},Yi.$elemMatch=function(t,e,n){return new i(t,e,n)},Yi.$nin=function(t,e,n){return new a(t,e,n)},Yi.$in=function(t,e,n){return new s(t,e,n)},Yi.$lt=Li.numericalOperation((function(t){return function(e){return e<t}})),Yi.$lte=Li.numericalOperation((function(t){return function(e){return e<=t}})),Yi.$gt=Li.numericalOperation((function(t){return function(e){return e>t}})),Yi.$gte=Li.numericalOperation((function(t){return function(e){return e>=t}})),Yi.$mod=function(t,e,n){var r=t[0],i=t[1];return new Li.EqualsOperation((function(t){return Ii.comparable(t)%r===i}),e,n)},Yi.$exists=function(t,e,n){return new u(t,e,n)},Yi.$regex=function(t,e,n){return new Li.EqualsOperation(new RegExp(t,e.$options),e,n)},Yi.$not=function(t,e,n){return new o(t,e,n)},Yi.$type=function(t,e,n){return new Li.EqualsOperation((function(e){return null!=e&&(e instanceof t||e.constructor===t)}),e,n)},Yi.$and=function(t,e,n){return new c(t,e,n)},Yi.$all=Yi.$and,Yi.$size=function(t,e,n){return new Li.EqualsOperation((function(e){return e&&e.length===t}),e,n)},Yi.$options=function(){return null},Yi.$where=function(e,n,r){var i;if(Ii.isFunction(e))i=e;else{if(t.env.CSP_ENABLED)throw new Error('In CSP mode, sift does not support strings in "$where" condition');i=new Function("obj","return "+e)}return new Li.EqualsOperation((function(t){return i.bind(t)(t)}),n,r)}}).call(this,require("_process"));var Xi={};Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.createQueryTester=Li.createQueryTester,Xi.EqualsOperation=Li.EqualsOperation,Xi.createEqualsOperation=Li.createEqualsOperation,function(t){for(var e in t)Xi.hasOwnProperty(e)||(Xi[e]=t[e])}(Yi),Xi.default=function(t,e){var n=void 0===e?{}:e,r=n.compare,i=n.operations;return Li.createQueryTester(t,{compare:r,operations:Object.assign({},Yi,i)})};var Ki={};Ki=Xi.default,Object.assign(Ki,Xi);const{DateTime:to}=b;const eo=/[|\\{}()[\]^$+*?.-]/g;var no;const ro=new Map;function io(t,e){e={caseSensitive:!1,...e};const n=t+JSON.stringify(e);if(ro.has(n))return ro.get(n);const r="!"===t[0];r&&(t=t.slice(1)),t=(t=>{if("string"!=typeof t)throw new TypeError("Expected a string");return t.replace(eo,"\\$&")})(t).replace(/\\\*/g,".*");const i=new RegExp(`^${t}$`,e.caseSensitive?"":"i");return i.negated=r,ro.set(n,i),i}(no=(t,e,n)=>{if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError(`Expected two arrays, got ${typeof t} ${typeof e}`);if(0===e.length)return t;const r="!"===e[0][0];e=e.map(t=>io(t,n));const i=[];for(const o of t){let t=r;for(const n of e)n.test(o)&&(t=!n.negated);t&&i.push(o)}return i}).isMatch=(t,e,n)=>{const r=Array.isArray(t)?t:[t],i=Array.isArray(e)?e:[e];return r.some(t=>i.every(e=>{const r=io(e,n),i=r.test(t);return r.negated?!i:i}))};const{DateTime:oo}=b;const so=async function(t,{db:e,ns:n,stream:r}){delete t.annotations[`${e}.${n}.${r}`]},ao=async function(t,{db:e,ns:n,stream:r}){return t.annotations[`${e}.${n}.${r}`]},uo=async function(t,{db:e}){},co=async function(t,{db:e}){t.events=t.events.filter(t=>t.meta.db!==e),t.index.events=Di(t.index.events,e+".")},lo=async function(t,{each:e}){const n=t.events.map(t=>t.meta.db).sort().filter((t,e,n)=>!e||t!==n[e-1]);for(const r of n)await e(r)},ho=async function(t,{db:e,ns:n,stream:r,event:i}){const o=t.index.events[`${e}.${n}.${r}.${i}`];delete t.index.events[`${e}.${n}.${r}.${i}`],delete t.events[o]},fo=async function(t,{identity:e,db:n,ns:r,stream:i,event:o}){const s=t.index.events[`${n}.${r}.${i}.${o}`];return t.events[s]},po=async function(t,{identity:e,db:n,ns:r}){},yo=async function(t,{db:e,ns:n}){t.events=t.events.filter(t=>t.meta.db!==e||t.meta.ns!==n),t.index.events=Di(t.index.events,`${e}.${n}.`)},mo=async function(t,{db:e,ns:n,from:r,after:i,to:o,until:s,types:a,filters:u,groupby:c,rollupto:l,limit:h,each:f}){let d=t.events.filter(t=>t.meta.db===e&&t.meta.ns===n);if(a&&(a=Array.isArray(a)?a:[a],d=d.filter(t=>a.some(e=>e===t.meta.type))),u&&u.forEach(t=>{let e={};Object.keys(t).forEach(n=>{n.startsWith("$")||n.startsWith("meta.")?e[n]=t[n]:e["data."+n]=t[n]}),d=d.filter(Ki(e))}),c&&c.timestamp)if(l){d=Pi.rollup(d,t=>{let e={};for(const n of Object.keys(l))"$count"===l[n]&&(e[n]=t.length);return e},t=>to.fromISO(t.meta.ts).toFormat(c.timestamp));let t=[];for(let[e,n]of d){for(const t of Object.keys(l))if("$key"===l[t]){n[t]=e;break}t.push(n)}d=t}else d=Pi.group(d,t=>to.fromISO(t.meta.ts).toFormat(c.timestamp));for(const p of d)await f(p)},vo=async function(t,{db:e,ns:n}){t.events=t.events.filter(t=>t.meta.db!==e||t.meta.ns!==n),t.index.events=Di(t.index.events,`${e}.${n}.`)},go=async function(t,{db:e,each:n}){const r=t.events.filter(t=>t.meta.db===e).map(t=>t.meta.ns).sort().filter((t,e,n)=>!e||t!==n[e-1]);for(const i of r)await n(i)},_o=async function(t,{db:e,ns:n,stream:r,annotation:i}){t.annotations[`${e}.${n}.${r}`]=i},bo=async function(t,{db:e,ns:n,stream:r}){t.events=t.events.filter(t=>t.meta.db!==e||t.meta.ns!==n||t.meta.stream!==r),t.index.events=Di(t.index.events,`${e}.${n}.${r}.`)},wo=async function(t,{db:e,ns:n,stream:r,from:i,after:o,to:s,until:a,types:u,limit:c,each:l}){let h=t.events.filter(t=>t.meta.db===e&&t.meta.ns===n&&t.meta.stream===r);if(u&&(u=Array.isArray(u)?u:[u],h=h.filter(t=>u.some(e=>no.isMatch(t.meta.type,e)))),i){const t=h.findIndex(t=>t.meta.id===i);t>=0&&(h=h.slice(t))}if(o){const t=h.findIndex(t=>t.meta.id===o);t>=0&&(h=h.slice(t+1))}if(s){const t=h.findIndex(t=>t.meta.id===s);t>=0&&(h=h.slice(0,t+1))}if(a){const t=h.findIndex(t=>t.meta.id===a);t>=0&&(h=h.slice(0,t))}c&&(h.length=Math.min(h.length,c));for(const f of h)await l(f)},ko=async function(t,{db:e,ns:n,stream:r,data:i,meta:o,id:s}){const a={data:i||{},meta:{tz:oo.local().zoneName,ts:(new Date).toISOString(),...o,id:s||xr(),stream:r,ns:n,db:e}},u=t.events.push(a)-1;t.index.events[`${e}.${n}.${r}.${a.meta.id}`]=u},Oo=async function(t,{db:e,ns:n,each:r}){const i=t.events.filter(t=>t.meta.db===e&&t.meta.ns===n).map(t=>t.meta.stream).sort().filter((t,e,n)=>!e||t!==n[e-1]);for(const o of i)await r(o)};var Eo={};(function(t){const e=class{constructor({credentials:t}){t&&(this.email=t.email,this.password=t.password)}get email(){return localStorage.getItem("email")}set email(t){localStorage.setItem("email",t)}async authenticate(t,{email:e,password:n}){localStorage.setItem("email",e),this.password=n,await t.details()}forget(){localStorage.removeItem("authorization"),localStorage.removeItem("email")}get credentials(){if(this.email||this.password)return{email:this.email,password:this.password}}async authorization(){return localStorage.getItem("authorization")||(this.credentials&&this.credentials.apikey?"Apikey "+this.credentials.apikey:this.credentials&&this.credentials.email&&this.credentials.password?"Basic "+(t=`${this.credentials.email}:${this.credentials.password}`,btoa(unescape(encodeURIComponent(t)))):void 0);var t}async authorized(t){localStorage.setItem("authorization",t)}async revoked(t){localStorage.removeItem("authorization")}};class i{async connect(t){return null===t.server?async function(t){const e=new class{constructor(){this.type="local",this.store={events:[],index:{events:{}},annotations:{}}}async destroyAnnotation(t){return n.handle(async()=>so(this.store,t))}async readAnnotation(t){return n.handle(async()=>ao(this.store,t))}async createDatabase(t){return n.handle(async()=>uo(this.store,t))}async destroyDatabase(t){return n.handle(async()=>co(this.store,t))}async listDatabases(t){return n.handle(async()=>lo(this.store,t))}async destroyEvent(t){return n.handle(async()=>ho(this.store,t))}async readEvent(t){return n.handle(async()=>fo(this.store,t))}async createNamespace(t){return n.handle(async()=>po(this.store,t))}async destroyNamespace(t){return n.handle(async()=>yo(this.store,t))}async readNamespace(t){return n.handle(async()=>mo(this.store,t))}async truncateNamespace(t){return n.handle(async()=>vo(this.store,t))}async listNamespaces(t){return n.handle(async()=>go(this.store,t))}async annotateStream(t){return n.handle(async()=>_o(this.store,t))}async destroyStream(t){return n.handle(async()=>bo(this.store,t))}async readStream(t){return n.handle(async()=>wo(this.store,t))}async writeStream(t){return n.handle(async()=>ko(this.store,t))}async listStreams(t){return n.handle(async()=>Oo(this.store,t))}}(t);return new Ni(e)}(t):t.server?o(t,t.server):o(t,`https://api${t&&t.environment?"-"+t.environment:""}.persistr.com`)}}async function o(t,e){const i=new class{constructor(t,e){this.type="persistr",this.identity=t,this.server=e,this.http=new class{constructor(t,e){this.server=t,this.identity=e,this.headers={}}url({endpoint:t,query:e}){return`${this.server}${t}${c(e)}`}async auth(){let t=void 0,e=void 0;var n;return this.identity&&this.identity.authorization&&(e=await this.identity.authorization()),e?t={authorization:e}:this.identity&&this.identity.credentials&&(this.identity.credentials.apikey?t={Authorization:"Apikey "+this.identity.credentials.apikey,...t}:this.identity.credentials.email&&this.identity.credentials.password&&(t={Authorization:"Basic "+(n=`${this.identity.credentials.email}:${this.identity.credentials.password}`,r(unescape(encodeURIComponent(n)))),...t})),t}async fetch({method:t,endpoint:e,query:r,body:i,headers:o}){const s=`${this.server}${e}${c(r)}`;let a={method:t,headers:{...this.headers,...await this.auth(),"content-type":"application/json",...o},credentials:"same-origin",mode:"cors"};i&&(a.headers["content-type"]&&a.headers["content-type"].includes("json")?a.body=JSON.stringify(i):a.body=i);let l=void 0;try{l=await u(s,{...a})}catch(f){if("ECONNREFUSED"===f.code)throw new n.ConnectionRefused;throw new n.Fetch(f.message)}if(!l.ok)throw new n.StatusCode(s,l.status,l.statusText,await l.text());l.headers.has("Authorization")&&this.identity.authorized&&this.identity.authorized(l.headers.get("Authorization"));let h=await l.text();return h&&(l.headers.has("content-type")?l.headers.get("content-type").includes("json")&&(h=JSON.parse(h)):h=JSON.parse(h)),{body:h||""}}async get(t){return await this.fetch({...t,method:"GET"})}async post(t){return await this.fetch({...t,method:"POST"})}async put(t){return await this.fetch({...t,method:"PUT"})}async patch(t){return await this.fetch({...t,method:"PATCH"})}async delete(t){return await this.fetch({...t,method:"DELETE"})}}(this.server,this.identity)}async getAccount(t){return n.handle(async()=>Tr(this.http,t))}async grantAccount(t){return n.handle(async()=>jr(this.http,t))}async revokeAccount(t){return n.handle(async()=>Fr(this.http,t))}async destroyAnnotation(t){return n.handle(async()=>Ar(this.http,t))}async readAnnotation(t){return n.handle(async()=>Nr(this.http,t))}async cloneDatabase(t){return n.handle(async()=>Dr(this.http,t))}async createDatabase(t){return n.handle(async()=>Pr(this.http,t))}async destroyDatabase(t){return n.handle(async()=>Ir(this.http,t))}async readDatabase(t){return n.handle(async()=>Rr(this.http,t))}async renameDatabase(t){return n.handle(async()=>Mr(this.http,t))}async listDatabases(t){return n.handle(async()=>Lr(this.http,t))}async destroyEvent(t){return n.handle(async()=>Vr(this.http,t))}async readEvent(t){return n.handle(async()=>$r(this.http,t))}async createNamespace(t){return n.handle(async()=>qr(this.http,t))}async destroyNamespace(t){return n.handle(async()=>Ur(this.http,t))}async readNamespace(t){return n.handle(async()=>zr(this.http,t))}async renameNamespace(t){return n.handle(async()=>Hr(this.http,t))}async truncateNamespace(t){return n.handle(async()=>Br(this.http,t))}async listNamespaces(t){return n.handle(async()=>Zr(this.http,t))}async annotateStream(t){return n.handle(async()=>Gr(this.http,t))}async destroyStream(t){return n.handle(async()=>Wr(this.http,t))}async readStream(t){return n.handle(async()=>Jr(this.http,t))}async writeStream(t){return n.handle(async()=>Qr(this.http,t))}async listStreams(t){return n.handle(async()=>Yr(this.http,t))}}(t,e);return new Ni(i)}Eo={Persistr:i,persistr:new i,Identity:e},"undefined"!=typeof window&&"[object Window]"==={}.toString.call(window)&&(t.persistr=Eo.persistr)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}();